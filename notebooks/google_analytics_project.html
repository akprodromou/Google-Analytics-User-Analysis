<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jupyter Notebook — generated with runcell</title>
    <meta name="description" content="Exported with runcell — convert .ipynb notebooks to HTML or PDF anytime at runcell.dev." />
    <meta name="generator" content="runcell" />
    <style>
        :root {
            --jp-code-font-family: 'SFMono-Regular', Menlo, Consolas, 'Liberation Mono', monospace;
            --jp-content-font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Helvetica, Arial, sans-serif;
            --jp-cell-prompt-width: 64px;
            --jp-input-prompt-color: #307fc1;
            --jp-output-prompt-color: #bf5b3d;
            --jp-cell-input-bg: #f7f7f7;
            --jp-layout-color0: #ffffff;
            --jp-layout-color1: #f7f7f7;
            --jp-border-color1: #e0e0e0;
            --jp-content-font-color0: #000000;
            --jp-content-font-color1: #333333;
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: var(--jp-content-font-family);
            font-size: 14px;
            line-height: 1.5;
            color: var(--jp-content-font-color0);
            background-color: var(--jp-layout-color0);
            margin: 0;
            padding: 0;
        }

        .notebook-container {
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
        }

        /* Cell structure */
        .cell {
            display: flex;
            flex-direction: row;
            margin-bottom: 12px;
            position: relative;
        }

        .cell-prompt {
            min-width: var(--jp-cell-prompt-width);
            width: var(--jp-cell-prompt-width);
            font-family: var(--jp-code-font-family);
            font-size: 12px;
            padding: 10px 8px 10px 0;
            text-align: right;
            flex-shrink: 0;
            user-select: none;
        }

        .cell-content {
            flex: 1;
            min-width: 0;
            overflow: hidden;
        }

        /* Input prompt styling - Jupyter blue */
        .input-prompt {
            color: var(--jp-input-prompt-color);
            font-weight: bold;
        }

        /* Output prompt styling - Jupyter red/orange */
        .output-prompt {
            color: var(--jp-output-prompt-color);
            font-weight: bold;
        }

        /* Code cell input area */
        .input-area {
            background-color: var(--jp-cell-input-bg);
            border: 1px solid var(--jp-border-color1);
            border-radius: 2px;
            padding: 8px 12px;
            overflow-x: auto;
        }

        .input-area pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Output area */
        .output-area {
            margin-top: 0;
        }

        .output-wrapper {
            display: flex;
            flex-direction: row;
            margin-top: 4px;
        }

        .output-content {
            flex: 1;
            min-width: 0;
            padding: 8px 0;
        }

        .output-content pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        /* Stream output (stdout/stderr) */
        .output-stream {
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            line-height: 1.4;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .output-stderr {
            background-color: #fdd;
            padding: 8px 12px;
            border-radius: 2px;
        }

        /* Execute result / display data */
        .output-result {
            padding: 4px 0;
        }

        .output-result pre {
            margin: 0;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
        }

        /* Image output */
        .output-image {
            max-width: 100%;
            height: auto;
            display: block;
        }

        /* HTML output (DataFrames, etc.) */
        .output-html {
            overflow-x: auto;
        }

        .output-html table {
            border-collapse: collapse;
            font-size: 13px;
            font-family: var(--jp-content-font-family);
        }

        .output-html table th,
        .output-html table td {
            border: 1px solid #ddd;
            padding: 6px 10px;
            text-align: left;
        }

        .output-html table th {
            background-color: #f5f5f5;
            font-weight: 600;
        }

        .output-html table tr:nth-child(even) {
            background-color: #fafafa;
        }

        /* Error output */
        .output-error {
            background-color: #fff0f0;
            padding: 8px 12px;
            border-radius: 2px;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            white-space: pre-wrap;
        }

        /* Markdown cell styling */
        .markdown-cell {
            padding: 10px 0;
        }

        .markdown-cell h1 {
            font-size: 2em;
            font-weight: 600;
            margin: 0.67em 0;
            padding-bottom: 0.3em;
            border-bottom: 1px solid var(--jp-border-color1);
        }

        .markdown-cell h2 {
            font-size: 1.5em;
            font-weight: 600;
            margin: 0.83em 0;
            padding-bottom: 0.3em;
            border-bottom: 1px solid var(--jp-border-color1);
        }

        .markdown-cell h3 {
            font-size: 1.25em;
            font-weight: 600;
            margin: 1em 0;
        }

        .markdown-cell h4 {
            font-size: 1em;
            font-weight: 600;
            margin: 1.33em 0;
        }

        .markdown-cell h5 {
            font-size: 0.875em;
            font-weight: 600;
            margin: 1.67em 0;
        }

        .markdown-cell h6 {
            font-size: 0.85em;
            font-weight: 600;
            margin: 2.33em 0;
            color: #6a737d;
        }

        .markdown-cell p {
            margin: 0 0 16px 0;
            line-height: 1.6;
        }

        .markdown-cell code {
            font-family: var(--jp-code-font-family);
            font-size: 85%;
            background-color: rgba(27, 31, 35, 0.05);
            padding: 0.2em 0.4em;
            border-radius: 3px;
        }

        .markdown-cell pre {
            background-color: var(--jp-cell-input-bg);
            border: 1px solid var(--jp-border-color1);
            border-radius: 3px;
            padding: 16px;
            overflow-x: auto;
            font-size: 85%;
            line-height: 1.45;
        }

        .markdown-cell pre code {
            background-color: transparent;
            padding: 0;
            border-radius: 0;
            font-size: 100%;
        }

        .markdown-cell blockquote {
            margin: 0 0 16px 0;
            padding: 0 1em;
            color: #6a737d;
            border-left: 4px solid #dfe2e5;
        }

        .markdown-cell ul,
        .markdown-cell ol {
            margin: 0 0 16px 0;
            padding-left: 2em;
        }

        .markdown-cell li {
            margin: 0.25em 0;
        }

        .markdown-cell a {
            color: #0366d6;
            text-decoration: none;
        }

        .markdown-cell a:hover {
            text-decoration: underline;
        }

        .markdown-cell hr {
            border: 0;
            border-top: 1px solid var(--jp-border-color1);
            margin: 24px 0;
        }

        .markdown-cell img {
            max-width: 100%;
            height: auto;
        }

        .markdown-cell table {
            border-collapse: collapse;
            margin: 0 0 16px 0;
        }

        .markdown-cell table th,
        .markdown-cell table td {
            border: 1px solid #dfe2e5;
            padding: 6px 13px;
        }

        .markdown-cell table th {
            font-weight: 600;
            background-color: #f6f8fa;
        }

        .markdown-cell table tr:nth-child(2n) {
            background-color: #f6f8fa;
        }

        /* Raw cell styling */
        .raw-cell {
            background-color: var(--jp-layout-color1);
            border: 1px solid var(--jp-border-color1);
            border-radius: 2px;
            padding: 8px 12px;
            font-family: var(--jp-code-font-family);
            font-size: 13px;
            white-space: pre-wrap;
        }

        /* Empty prompt placeholder */
        .prompt-empty {
            color: transparent;
        }

        .export-footer {
            margin-top: 32px;
            padding-top: 16px;
            border-top: 1px solid var(--jp-border-color1);
            color: #555;
            font-size: 13px;
            text-align: center;
        }

        .export-footer a {
            color: #0366d6;
            text-decoration: none;
        }

        .export-footer a:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="notebook-container">
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h1>Google Analytics Data Analysis (BigQuery)</h1><br><br><h2>Introduction - Understanding the problem</h2><br><br><h3>Dataset Description</h3><br><br>In this project, we will be working with the Google Analytics Sample Dataset hosted in Google BigQuery that can be found at:<br><br><code>bigquery-public-data.google_analytics_sample.ga_sessions_20170801</code><br><br>This dataset contains a single day (August 1, 2017) of anonymized Google Analytics session data for a fictional e-commerce store. It<br>includes information such as a) Traffic source data: where website visitors originate from, including data about organic traffic, paid search traffic, and display traffic b) Content data: information about the behavior of users on the site, such as URLs of pages that visitors look at, how they interact with content, etc. c) Transactional data: information about the transactions on the Google Merchandise Store website.<br><br>I'll be working with GoogleSQL along the project.<br><br><h3>Project Goal</h3><br><br>The main goals of this analysis are to:<br>- Understand the behavior of users visiting the site. That could include questions such as which pages were viewed mostly? How long did they stay on each page? Did they click through that page / went back to the previous one / ended their session? Did they encounter issues? Are UX/UI changes that can help resolve these issues?<br>- Analyze traffic sources, user devices (for example mobile phone or laptop) and/or browsers, their location (e.g. country or city), and engagement. Knowing which traffic sources bring the most users and revenue can help both focus on them and make adjustments to improve the experience in the remaining sources.<br>- Can we identify any key factors leading to transactions and revenue generation? This could lead to business actions that optimize user acquisition, site engagement, and conversions.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>1. Data Structure</h2><br><br>We'll start by loading BigQuery:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%load_ext bigquery_magics
# To supress warnings and make our notebook more legible
import warnings
warnings.filterwarnings('ignore')
from google.cloud import bigquery
from google.oauth2 import service_account
# I'll use pandas to explore table structures, field values etc
import pandas as pd
# for plotting
import matplotlib.pyplot as plt
import plotly.graph_objects as go
import plotly.io as pio
!pip install nbstripout -q</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>key_path = "data/week-3-bigquery-369916-341d3b137e42.json"

# Create credentials object
credentials = service_account.Credentials.from_service_account_file(key_path)

# Set context manually
from google.cloud.bigquery import magics
magics.context.credentials = credentials
magics.context.project = credentials.project_id

# data visualisation settings
pio.templates.default = "plotly_white"
color_palette = ['#8c4053', '#40798C','#a170a9', '#70A9A1']</pre></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery df
-- Create a dataframe from the table - this will only be used to explore nested content, unique values etc
SELECT *
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>df.info()</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">&lt;class 'pandas.core.frame.DataFrame'&gt;
RangeIndex: 2556 entries, 0 to 2555
Data columns (total 16 columns):
 #   Column                Non-Null Count  Dtype 
---  ------                --------------  ----- 
 0   visitorId             0 non-null      Int64 
 1   visitNumber           2556 non-null   Int64 
 2   visitId               2556 non-null   Int64 
 3   visitStartTime        2556 non-null   Int64 
 4   date                  2556 non-null   object
 5   totals                2556 non-null   object
 6   trafficSource         2556 non-null   object
 7   device                2556 non-null   object
 8   geoNetwork            2556 non-null   object
 9   customDimensions      2556 non-null   object
 10  hits                  2556 non-null   object
 11  fullVisitorId         2556 non-null   object
 12  userId                0 non-null      object
 13  clientId              0 non-null      object
 14  channelGrouping       2556 non-null   object
 15  socialEngagementType  2556 non-null   object
dtypes: Int64(4), object(12)
memory usage: 329.6+ KB
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Going through the [Google Analytics documentation](https://support.google.com/analytics/answer/3437719?hl=en), we can see that <code>visitorId</code> is deprecated and hence null in this case, <code>userId</code> is a special feature designed to track a single user across multiple devices; a website needs explicit configurion to track it; <code>clientId</code> is an unhashed identifier. <code>fullVisitorId</code> is the primary identifier used by Google Analytics to track a unique client/device across multiple visits, as it is tied to the GA cookie stored in the user's browser.<br><br>The rest of the columns contain no null values, which is good. I won't be dropping the null ones, since I'll be working with SQL (therefore simply selecting the appropriate ones).<br></div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Let's look inside the <code>totals</code> column:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>df['totals']</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>totals</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2551</th>
      <td>{'visits': 1, 'hits': 84, 'pageviews': 60, 'ti...</td>
    </tr>
    <tr>
      <th>2552</th>
      <td>{'visits': 1, 'hits': 100, 'pageviews': 72, 't...</td>
    </tr>
    <tr>
      <th>2553</th>
      <td>{'visits': 1, 'hits': 140, 'pageviews': 93, 't...</td>
    </tr>
    <tr>
      <th>2554</th>
      <td>{'visits': 1, 'hits': 156, 'pageviews': 112, '...</td>
    </tr>
    <tr>
      <th>2555</th>
      <td>{'visits': 1, 'hits': 193, 'pageviews': 106, '...</td>
    </tr>
  </tbody>
</table>
<p>2556 rows × 1 columns</p>
</div><br><label><b>dtype:</b> object</label></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># Since 'totals' is a nested STRUCT, I'll expand it using json_normalize
df_totals = pd.json_normalize(df['totals'])

print(df_totals.columns)</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-stream">Index(['visits', 'hits', 'pageviews', 'timeOnSite', 'bounces', 'transactions',
       'transactionRevenue', 'newVisits', 'screenviews', 'uniqueScreenviews',
       'timeOnScreen', 'totalTransactionRevenue', 'sessionQualityDim'],
      dtype='object')
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">We can see that <code>totals</code> contains session-level metrics, meaning these values summarize the activity that occurred during a single user session. Now let's look at <code>hits</code>. We already know that, by definition, a hit in Google Analytics refers to any user interaction with the website that results in data being sent to the Analytics server:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># Explore the hits column
df['hits']</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>hits</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 5, 'minut...</td>
    </tr>
    <tr>
      <th>1</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 5, 'minut...</td>
    </tr>
    <tr>
      <th>2</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
    </tr>
    <tr>
      <th>3</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 8, 'minut...</td>
    </tr>
    <tr>
      <th>4</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
    </tr>
    <tr>
      <th>2551</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 18, 'minu...</td>
    </tr>
    <tr>
      <th>2552</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 9, 'minut...</td>
    </tr>
    <tr>
      <th>2553</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
    </tr>
    <tr>
      <th>2554</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 15, 'minu...</td>
    </tr>
    <tr>
      <th>2555</th>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 14, 'minu...</td>
    </tr>
  </tbody>
</table>
<p>2556 rows × 1 columns</p>
</div><br><label><b>dtype:</b> object</label></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">We see thtat <code>hits</code> is a list of dictionaries, let's look at an example:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre># List the keys of the first hit
df['hits'].iloc[0][0].keys()</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>dict_keys(['hitNumber', 'time', 'hour', 'minute', 'isSecure', 'isInteraction', 'isEntrance', 'isExit', 'referer', 'page', 'transaction', 'item', 'contentInfo', 'appInfo', 'exceptionInfo', 'eventInfo', 'product', 'promotion', 'promotionActionInfo', 'refund', 'eCommerceAction', 'experiment', 'publisher', 'customVariables', 'customDimensions', 'customMetrics', 'type', 'social', 'latencyTracking', 'sourcePropertyInfo', 'contentGroup', 'dataSource', 'publisher_infos'])</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><code>hits</code> appears to be a rather complex column. While the totals column summarized a session, the hits column contains a list of individual user actions that occurred during that session.<br><br>I'll now use SQL to see how many unique users we have, out of the 2556 rows (sessions):</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT COUNT(DISTINCT fullVisitorId) AS unique_users
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-2904bcf0-c864-4250-94b2-c83de42f88ff" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>unique_users</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2293</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-2904bcf0-c864-4250-94b2-c83de42f88ff')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-2904bcf0-c864-4250-94b2-c83de42f88ff button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-2904bcf0-c864-4250-94b2-c83de42f88ff');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Let's also use SQL to have a glimpse at the dataset (similar to the <code>head()</code> function in Python):</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT *
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
LIMIT 5;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-0ad0906f-70fb-4c4e-82ba-4d6d100d0978" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>visitorId</th>
      <th>visitNumber</th>
      <th>visitId</th>
      <th>visitStartTime</th>
      <th>date</th>
      <th>totals</th>
      <th>trafficSource</th>
      <th>device</th>
      <th>geoNetwork</th>
      <th>customDimensions</th>
      <th>hits</th>
      <th>fullVisitorId</th>
      <th>userId</th>
      <th>clientId</th>
      <th>channelGrouping</th>
      <th>socialEngagementType</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>&lt;NA&gt;</td>
      <td>1</td>
      <td>1501591568</td>
      <td>1501591568</td>
      <td>20170801</td>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
      <td>{'referralPath': None, 'campaign': '(not set)'...</td>
      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
      <td>{'continent': 'Europe', 'subContinent': 'South...</td>
      <td>[]</td>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 5, 'minut...</td>
      <td>3418334011779872055</td>
      <td>None</td>
      <td>None</td>
      <td>Organic Search</td>
      <td>Not Socially Engaged</td>
    </tr>
    <tr>
      <th>1</th>
      <td>&lt;NA&gt;</td>
      <td>2</td>
      <td>1501589647</td>
      <td>1501589647</td>
      <td>20170801</td>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
      <td>{'referralPath': '/analytics/web/', 'campaign'...</td>
      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
      <td>{'continent': 'Asia', 'subContinent': 'Souther...</td>
      <td>[{'index': 4, 'value': 'APAC'}]</td>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 5, 'minut...</td>
      <td>2474397855041322408</td>
      <td>None</td>
      <td>None</td>
      <td>Referral</td>
      <td>Not Socially Engaged</td>
    </tr>
    <tr>
      <th>2</th>
      <td>&lt;NA&gt;</td>
      <td>1</td>
      <td>1501616621</td>
      <td>1501616621</td>
      <td>20170801</td>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
      <td>{'referralPath': '/analytics/web/', 'campaign'...</td>
      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
      <td>{'continent': 'Europe', 'subContinent': 'North...</td>
      <td>[{'index': 4, 'value': 'EMEA'}]</td>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
      <td>5870462820713110108</td>
      <td>None</td>
      <td>None</td>
      <td>Referral</td>
      <td>Not Socially Engaged</td>
    </tr>
    <tr>
      <th>3</th>
      <td>&lt;NA&gt;</td>
      <td>1</td>
      <td>1501601200</td>
      <td>1501601200</td>
      <td>20170801</td>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
      <td>{'referralPath': '/analytics/web/', 'campaign'...</td>
      <td>{'browser': 'Firefox', 'browserVersion': 'not ...</td>
      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>
      <td>[{'index': 4, 'value': 'North America'}]</td>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 8, 'minut...</td>
      <td>9397809171349480379</td>
      <td>None</td>
      <td>None</td>
      <td>Referral</td>
      <td>Not Socially Engaged</td>
    </tr>
    <tr>
      <th>4</th>
      <td>&lt;NA&gt;</td>
      <td>1</td>
      <td>1501615525</td>
      <td>1501615525</td>
      <td>20170801</td>
      <td>{'visits': 1, 'hits': 1, 'pageviews': 1, 'time...</td>
      <td>{'referralPath': '/analytics/web/', 'campaign'...</td>
      <td>{'browser': 'Chrome', 'browserVersion': 'not a...</td>
      <td>{'continent': 'Americas', 'subContinent': 'Nor...</td>
      <td>[{'index': 4, 'value': 'North America'}]</td>
      <td>[{'hitNumber': 1, 'time': 0, 'hour': 12, 'minu...</td>
      <td>6089902943184578335</td>
      <td>None</td>
      <td>None</td>
      <td>Referral</td>
      <td>Not Socially Engaged</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-0ad0906f-70fb-4c4e-82ba-4d6d100d0978')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-0ad0906f-70fb-4c4e-82ba-4d6d100d0978 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-0ad0906f-70fb-4c4e-82ba-4d6d100d0978');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-3569c163-c96f-4afd-a77f-4d700503003f">
      <button class="colab-df-quickchart" onclick="quickchart('df-3569c163-c96f-4afd-a77f-4d700503003f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-3569c163-c96f-4afd-a77f-4d700503003f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">We can see from the above that many fields are nested (like totals, device, geoNetwork).<br><br>Let's check the data types of the table attributes:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  column_name,
  data_type
FROM `bigquery-public-data.google_analytics_sample.INFORMATION_SCHEMA.COLUMNS`
WHERE table_name = 'ga_sessions_20170801';</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-98c3e013-3cc0-4175-815b-4127e5e55034" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>column_name</th>
      <th>data_type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>visitorId</td>
      <td>INT64</td>
    </tr>
    <tr>
      <th>1</th>
      <td>visitNumber</td>
      <td>INT64</td>
    </tr>
    <tr>
      <th>2</th>
      <td>visitId</td>
      <td>INT64</td>
    </tr>
    <tr>
      <th>3</th>
      <td>visitStartTime</td>
      <td>INT64</td>
    </tr>
    <tr>
      <th>4</th>
      <td>date</td>
      <td>STRING</td>
    </tr>
    <tr>
      <th>5</th>
      <td>totals</td>
      <td>STRUCT&lt;visits INT64, hits INT64, pageviews INT...</td>
    </tr>
    <tr>
      <th>6</th>
      <td>trafficSource</td>
      <td>STRUCT&lt;referralPath STRING, campaign STRING, s...</td>
    </tr>
    <tr>
      <th>7</th>
      <td>device</td>
      <td>STRUCT&lt;browser STRING, browserVersion STRING, ...</td>
    </tr>
    <tr>
      <th>8</th>
      <td>geoNetwork</td>
      <td>STRUCT&lt;continent STRING, subContinent STRING, ...</td>
    </tr>
    <tr>
      <th>9</th>
      <td>customDimensions</td>
      <td>ARRAY&lt;STRUCT&lt;index INT64, value STRING&gt;&gt;</td>
    </tr>
    <tr>
      <th>10</th>
      <td>hits</td>
      <td>ARRAY&lt;STRUCT&lt;hitNumber INT64, time INT64, hour...</td>
    </tr>
    <tr>
      <th>11</th>
      <td>fullVisitorId</td>
      <td>STRING</td>
    </tr>
    <tr>
      <th>12</th>
      <td>userId</td>
      <td>STRING</td>
    </tr>
    <tr>
      <th>13</th>
      <td>clientId</td>
      <td>STRING</td>
    </tr>
    <tr>
      <th>14</th>
      <td>channelGrouping</td>
      <td>STRING</td>
    </tr>
    <tr>
      <th>15</th>
      <td>socialEngagementType</td>
      <td>STRING</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-98c3e013-3cc0-4175-815b-4127e5e55034')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-98c3e013-3cc0-4175-815b-4127e5e55034 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-98c3e013-3cc0-4175-815b-4127e5e55034');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-d4c199c7-ad62-4546-a79d-1b07934d740f">
      <button class="colab-df-quickchart" onclick="quickchart('df-d4c199c7-ad62-4546-a79d-1b07934d740f')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-d4c199c7-ad62-4546-a79d-1b07934d740f button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The most important takeaway is that in many columns data is stored in a nested / semi-structured format, i.e. <code>STRUCT</code> and <code>ARRAY</code> data types. These columns must be flattened to perform analysis on them.<br><br>Let's have a look at some of the nested data in them:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  totals.visits,
  totals.pageviews,
  totals.transactionRevenue,
  device.deviceCategory,
  device.isMobile,
  trafficSource.source,
  trafficSource.medium,
  geoNetwork.country
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
LIMIT 5;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-7e56932d-0961-4d39-9b7b-7fa9f2bfe3f7" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>visits</th>
      <th>pageviews</th>
      <th>transactionRevenue</th>
      <th>deviceCategory</th>
      <th>isMobile</th>
      <th>source</th>
      <th>medium</th>
      <th>country</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>desktop</td>
      <td>False</td>
      <td>(direct)</td>
      <td>(none)</td>
      <td>Greece</td>
    </tr>
    <tr>
      <th>1</th>
      <td>1</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>desktop</td>
      <td>False</td>
      <td>analytics.google.com</td>
      <td>referral</td>
      <td>India</td>
    </tr>
    <tr>
      <th>2</th>
      <td>1</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>desktop</td>
      <td>False</td>
      <td>analytics.google.com</td>
      <td>referral</td>
      <td>United Kingdom</td>
    </tr>
    <tr>
      <th>3</th>
      <td>1</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>desktop</td>
      <td>False</td>
      <td>analytics.google.com</td>
      <td>referral</td>
      <td>United States</td>
    </tr>
    <tr>
      <th>4</th>
      <td>1</td>
      <td>1</td>
      <td>&lt;NA&gt;</td>
      <td>desktop</td>
      <td>False</td>
      <td>adwords.google.com</td>
      <td>referral</td>
      <td>United States</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7e56932d-0961-4d39-9b7b-7fa9f2bfe3f7')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7e56932d-0961-4d39-9b7b-7fa9f2bfe3f7 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7e56932d-0961-4d39-9b7b-7fa9f2bfe3f7');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-675a5092-3a54-48fb-8bfc-70f6f8407cd9">
      <button class="colab-df-quickchart" onclick="quickchart('df-675a5092-3a54-48fb-8bfc-70f6f8407cd9')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-675a5092-3a54-48fb-8bfc-70f6f8407cd9 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">With regards to <code>pageviews</code> in specific, some descriptive statistics are as follows:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  MIN(totals.pageviews) AS min_pageviews,
  MAX(totals.pageviews) AS max_pageviews,
  AVG(totals.pageviews) AS avg_pageviews,
  STDDEV(totals.pageviews) AS std_pageviews,
  COUNT(*) AS total_rows,
  COUNTIF(totals.pageviews IS NULL) AS null_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-526ef80e-d4af-4020-836f-49e2e31dda7b" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_pageviews</th>
      <th>max_pageviews</th>
      <th>avg_pageviews</th>
      <th>std_pageviews</th>
      <th>total_rows</th>
      <th>null_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>155</td>
      <td>4.279734</td>
      <td>7.966343</td>
      <td>2556</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-526ef80e-d4af-4020-836f-49e2e31dda7b')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-526ef80e-d4af-4020-836f-49e2e31dda7b button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-526ef80e-d4af-4020-836f-49e2e31dda7b');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Similarly for <code>transactions</code>:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  MIN(totals.transactions) AS min_transactions,
  MAX(totals.transactions) AS max_transactions,
  AVG(totals.transactions) AS avg_transactions,
  STDDEV(totals.transactions) AS std_transactions,
  COUNT(*) AS total_rows,
  COUNTIF(totals.transactions IS NULL) AS null_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-8ed0fbf9-9d60-41fe-8327-32d3c26f1221" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_transactions</th>
      <th>max_transactions</th>
      <th>avg_transactions</th>
      <th>std_transactions</th>
      <th>total_rows</th>
      <th>null_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>2</td>
      <td>1.046512</td>
      <td>0.213083</td>
      <td>2556</td>
      <td>2513</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8ed0fbf9-9d60-41fe-8327-32d3c26f1221')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8ed0fbf9-9d60-41fe-8327-32d3c26f1221 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8ed0fbf9-9d60-41fe-8327-32d3c26f1221');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">It's important to note that in this dataset, <code>totals.transactionRevenue</code> is recorded in micro-units of the currency. Therefore we need to divide the sum by 10^6, in order to convert microdollars to dollars. The revenue metrics will therefore be calculated as follows:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  MIN(totals.transactionRevenue) / 1e6 AS min_transactionRevenue,
  MAX(totals.transactionRevenue) / 1e6 AS max_transactionRevenue,
  AVG(totals.transactionRevenue) / 1e6 AS avg_transactionRevenue,
  STDDEV(totals.transactionRevenue) / 1e6 AS std_transactionRevenue,
  COUNT(*) AS total_rows,
  COUNTIF(totals.transactionRevenue IS NULL) / 1e6 AS null_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-6b9b4405-b703-49a8-a2d9-1e769bacf005" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>min_transactionRevenue</th>
      <th>max_transactionRevenue</th>
      <th>avg_transactionRevenue</th>
      <th>std_transactionRevenue</th>
      <th>total_rows</th>
      <th>null_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1.99</td>
      <td>2933.61</td>
      <td>193.13814</td>
      <td>478.700758</td>
      <td>2556</td>
      <td>0.002513</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6b9b4405-b703-49a8-a2d9-1e769bacf005')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6b9b4405-b703-49a8-a2d9-1e769bacf005 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6b9b4405-b703-49a8-a2d9-1e769bacf005');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>2. Data Cleaning</h2><br><br>How many sessions have missing user IDs (it's the <code>fullVisitorId</code> used for cookie tracking)?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  COUNT(*) AS sessions_missing_userid
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
WHERE fullVisitorId IS NULL;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-6cbf1f3d-944c-41a8-8cfe-818318d8fed8" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sessions_missing_userid</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-6cbf1f3d-944c-41a8-8cfe-818318d8fed8')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-6cbf1f3d-944c-41a8-8cfe-818318d8fed8 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-6cbf1f3d-944c-41a8-8cfe-818318d8fed8');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">How many sessions have transactions recorded?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  COUNT(*) AS sessions_with_transactions
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
WHERE totals.transactions IS NOT NULL;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-526b5746-04e8-4de8-867f-4277cfcc865e" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sessions_with_transactions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>43</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-526b5746-04e8-4de8-867f-4277cfcc865e')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-526b5746-04e8-4de8-867f-4277cfcc865e button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-526b5746-04e8-4de8-867f-4277cfcc865e');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">How many sessions have pageviews?</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  COUNT(*) AS sessions_with_pageviews
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
WHERE totals.pageviews IS NOT NULL;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-44d84236-5195-4b51-a065-1defa12e6165" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>sessions_with_pageviews</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2556</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-44d84236-5195-4b51-a065-1defa12e6165')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-44d84236-5195-4b51-a065-1defa12e6165 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-44d84236-5195-4b51-a065-1defa12e6165');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">...which was expected! Now let's check for default 'na' placeholders:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  trafficSource.source,
  COUNT(*) AS session_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY trafficSource.source
ORDER BY session_count DESC;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-9dee02c3-7b53-4098-9eaa-5a596fe746e4" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source</th>
      <th>session_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(direct)</td>
      <td>2166</td>
    </tr>
    <tr>
      <th>1</th>
      <td>youtube.com</td>
      <td>180</td>
    </tr>
    <tr>
      <th>2</th>
      <td>analytics.google.com</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Partners</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>dfa</td>
      <td>15</td>
    </tr>
    <tr>
      <th>5</th>
      <td>google.com</td>
      <td>12</td>
    </tr>
    <tr>
      <th>6</th>
      <td>sites.google.com</td>
      <td>8</td>
    </tr>
    <tr>
      <th>7</th>
      <td>facebook.com</td>
      <td>7</td>
    </tr>
    <tr>
      <th>8</th>
      <td>quora.com</td>
      <td>6</td>
    </tr>
    <tr>
      <th>9</th>
      <td>m.facebook.com</td>
      <td>5</td>
    </tr>
    <tr>
      <th>10</th>
      <td>baidu</td>
      <td>5</td>
    </tr>
    <tr>
      <th>11</th>
      <td>qiita.com</td>
      <td>5</td>
    </tr>
    <tr>
      <th>12</th>
      <td>reddit.com</td>
      <td>4</td>
    </tr>
    <tr>
      <th>13</th>
      <td>groups.google.com</td>
      <td>4</td>
    </tr>
    <tr>
      <th>14</th>
      <td>l.facebook.com</td>
      <td>3</td>
    </tr>
    <tr>
      <th>15</th>
      <td>blog.golang.org</td>
      <td>3</td>
    </tr>
    <tr>
      <th>16</th>
      <td>ask</td>
      <td>2</td>
    </tr>
    <tr>
      <th>17</th>
      <td>adwords.google.com</td>
      <td>2</td>
    </tr>
    <tr>
      <th>18</th>
      <td>mail.google.com</td>
      <td>2</td>
    </tr>
    <tr>
      <th>19</th>
      <td>yahoo</td>
      <td>2</td>
    </tr>
    <tr>
      <th>20</th>
      <td>lm.facebook.com</td>
      <td>2</td>
    </tr>
    <tr>
      <th>21</th>
      <td>sashihara.jp</td>
      <td>1</td>
    </tr>
    <tr>
      <th>22</th>
      <td>m.baidu.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>23</th>
      <td>ph.search.yahoo.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>24</th>
      <td>productforums.google.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>25</th>
      <td>support.google.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>26</th>
      <td>google.com.vn</td>
      <td>1</td>
    </tr>
    <tr>
      <th>27</th>
      <td>datastudio.google.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>28</th>
      <td>google.com.tw</td>
      <td>1</td>
    </tr>
    <tr>
      <th>29</th>
      <td>int.search.tb.ask.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>30</th>
      <td>docs.google.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>bing</td>
      <td>1</td>
    </tr>
    <tr>
      <th>32</th>
      <td>away.vk.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>33</th>
      <td>pinterest.com</td>
      <td>1</td>
    </tr>
    <tr>
      <th>34</th>
      <td>dealspotr.com</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-9dee02c3-7b53-4098-9eaa-5a596fe746e4')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-9dee02c3-7b53-4098-9eaa-5a596fe746e4 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-9dee02c3-7b53-4098-9eaa-5a596fe746e4');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-3068f022-1366-4f90-abdf-567859c853bb">
      <button class="colab-df-quickchart" onclick="quickchart('df-3068f022-1366-4f90-abdf-567859c853bb')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-3068f022-1366-4f90-abdf-567859c853bb button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">There is none present, which is good.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>3. Exploratory Data Analysis (EDA)</h2><br><br>In this section, we will investigate the business questions defined in the introduction, such as which traffic sources bring the most users and/or revenue? What device types are most common among buyers? Are new users or returning users more likely to make a purchase? Which countries generate the most sessions or revenue?<br><br><h3>Traffic Sources</h3><br><br>To examine traffic sources, I'll start by a) aggregating sessions and revenue by <code>trafficSource.source</code> and <code>trafficSource.medium</code> and then b) rank sources by number of sessions and by transaction revenue.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
    trafficSource.source,
    COUNT(*) AS session_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY trafficSource.source
ORDER BY session_count DESC
LIMIT 5;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-e758bad1-774b-4148-a3d1-021155ee0055" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source</th>
      <th>session_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(direct)</td>
      <td>2166</td>
    </tr>
    <tr>
      <th>1</th>
      <td>youtube.com</td>
      <td>180</td>
    </tr>
    <tr>
      <th>2</th>
      <td>analytics.google.com</td>
      <td>57</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Partners</td>
      <td>52</td>
    </tr>
    <tr>
      <th>4</th>
      <td>dfa</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e758bad1-774b-4148-a3d1-021155ee0055')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e758bad1-774b-4148-a3d1-021155ee0055 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e758bad1-774b-4148-a3d1-021155ee0055');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-7c5146ee-d15e-497a-b598-37a6b03cc7ce">
      <button class="colab-df-quickchart" onclick="quickchart('df-7c5146ee-d15e-497a-b598-37a6b03cc7ce')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-7c5146ee-d15e-497a-b598-37a6b03cc7ce button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Once again, I divide sums by 10^6, in order to convert microdollars to dollars, prior to looking at revenue by traffic source:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery
# Ranking traffic sources by revenue in million dollars

SELECT
    trafficSource.source,
    SUM(totals.transactionRevenue) / 1e6 AS sources_revenue_million
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY trafficSource.source
ORDER BY sources_revenue_million DESC
LIMIT 5;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-7e359a7c-f33a-4c9f-a844-190e9e20aa70" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source</th>
      <th>sources_revenue_million</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(direct)</td>
      <td>8292.98</td>
    </tr>
    <tr>
      <th>1</th>
      <td>mail.google.com</td>
      <td>11.96</td>
    </tr>
    <tr>
      <th>2</th>
      <td>ask</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>productforums.google.com</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>adwords.google.com</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-7e359a7c-f33a-4c9f-a844-190e9e20aa70')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-7e359a7c-f33a-4c9f-a844-190e9e20aa70 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-7e359a7c-f33a-4c9f-a844-190e9e20aa70');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-ad8da2c6-f249-41aa-a1bc-9a32fe5436e0">
      <button class="colab-df-quickchart" onclick="quickchart('df-ad8da2c6-f249-41aa-a1bc-9a32fe5436e0')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-ad8da2c6-f249-41aa-a1bc-9a32fe5436e0 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">So (direct) traffic is the main source of visitors and generated \$8,292.98 of revenue; <code>mail.google.com</code> generated \$11.96 of revenue, while the remaining sources (<code>analytics.google.com</code>, etc.) generated no revenue.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery
# ranking traffic by medium

SELECT
    trafficSource.medium,
    COUNT(*) AS session_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY trafficSource.medium
ORDER BY session_count DESC
LIMIT 10;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-d0347402-04b9-42a3-a82a-4cdeaf1b6d4a" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>medium</th>
      <th>session_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>(none)</td>
      <td>2166</td>
    </tr>
    <tr>
      <th>1</th>
      <td>referral</td>
      <td>313</td>
    </tr>
    <tr>
      <th>2</th>
      <td>affiliate</td>
      <td>52</td>
    </tr>
    <tr>
      <th>3</th>
      <td>cpm</td>
      <td>15</td>
    </tr>
    <tr>
      <th>4</th>
      <td>organic</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-d0347402-04b9-42a3-a82a-4cdeaf1b6d4a')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-d0347402-04b9-42a3-a82a-4cdeaf1b6d4a button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-d0347402-04b9-42a3-a82a-4cdeaf1b6d4a');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-1237f283-894d-451b-bb8d-bc4a73bee8b7">
      <button class="colab-df-quickchart" onclick="quickchart('df-1237f283-894d-451b-bb8d-bc4a73bee8b7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-1237f283-894d-451b-bb8d-bc4a73bee8b7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The different medium definitions are as follows:<br><br>| Medium    | Meaning |<br>|:----------|:--------|<br>| (none)    | Direct traffic (e.g. entering the URL directly) |<br>| referral  | Clicking on a link from another website |<br>| affiliate | Traffic from affiliate marketing partners |<br>| cpm       | Paid display ads (Cost per Mille = 1000 impressions) |<br>| organic   | Organic search (unpaid results from Google, etc.) |</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Device Analysis</h3><br><br>We'll next breakdown sessions, transactions, and revenue by device Category and whether the device was mobile or not:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery df

SELECT
  device.deviceCategory AS device_category,
  COUNT(*) AS device_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY device_category
ORDER BY device_count DESC;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">Let's plot the device sources</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>plt.figure(figsize=(6, 4))
plt.bar(
    df['device_category'],
    df['device_count'],
    color=color_palette[0]
)

# labels and title
plt.ylabel("Number of Sessions")
plt.title("Device Category Counts")

# remove surrounding bounding box / spines
ax = plt.gca()
for spine in ["top", "right", "left", "bottom"]:
    ax.spines[spine].set_visible(False)

ax.tick_params(left=False, bottom=False)

plt.xticks(rotation=0)
plt.show()</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <img class="output-image" src="data:image/png;base64,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UFCZdQsXLoSdnR2aNWuGxYsXo6ioSFqXkJCADh06QK1WS21+fn5ISUlBVlbWS6mdiIiInq9SR0o0sXbtWlhYWKBPnz6y9gkTJqB58+awtbXFb7/9hhkzZiA9PR1Lly4FAGRkZMDNzU22jaOjo7TOxsbm5ZwAERERPdMrE0pWr16NIUOGwNTUVNYeFhYmfd+4cWOo1WqMHj0aCxYsgImJycsuk4iIiF7QKxFKjhw5gpSUFERHRz+3r6enJ4qKinD9+nXUq1cPTk5OyMzMlPUpXX7aPJSXaUnnfpVdAunQlINbKrsEIqJXxisxp+S7775DixYt0KRJk+f2TUxMhIGBARwcHAAAXl5eiIuLQ2FhodQnNjYW9erV46UbIiIiBanUUJKbm4vExEQkJiYCAFJTU5GYmIi0tDSpT05ODjZv3oz333+/zPYJCQlYtmwZzp49i2vXrmHdunWYPHkyhg4dKgWOwYMHQ61WIygoCOfPn0d0dDSWL18uu+xDREREla9SL9+cPHkSnTt3lpZLg0JgYCCioqIAABs3boQQAoMGDSqzvYmJCTZu3IiIiAg8evQIbm5umDx5sixwWFlZYe/evQgJCUGLFi1gb2+PWbNm8XZgIiIihVEJIURlF6HPOKfk9cY5JUREFfdKzCkhIiKi1x9DCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKUKlhpK4uDj06NEDLi4uUKlU2L59u2z98OHDoVKpZF9du3aV9bl37x6GDBkCS0tLWFtbIygoCLm5ubI+SUlJaN++PUxNTVGzZk1ERkbq+tSIiIhIQ5UaSvLy8tCkSROsXLnyqX26du2K9PR06WvDhg2y9UOGDMH58+cRGxuLnTt3Ii4uDqNGjZLW5+TkwNfXF66urjh16hQWL16MiIgIfP311zo7LyIiItKcUWUe3N/fH/7+/s/sY2JiAicnp3LXJScnIyYmBidOnEDLli0BAJ9//jm6deuGTz/9FC4uLli3bh0KCgqwevVqqNVqNGzYEImJiVi6dKksvBAREVHlUvyckkOHDsHBwQH16tXD2LFjcffuXWldQkICrK2tpUACAD4+PjAwMMCxY8ekPh06dIBarZb6+Pn5ISUlBVlZWS/vRIiIiOiZFB1Kunbtiu+//x779+/HokWLcPjwYfj7+6O4uBgAkJGRAQcHB9k2RkZGsLW1RUZGhtTH0dFR1qd0ubQPERERVb5KvXzzPAMHDpS+9/DwQOPGjVGnTh0cOnQI3t7elVgZERERaZuiR0qeVLt2bdjb2+PKlSsAACcnJ9y+fVvWp6ioCPfu3ZPmoTg5OSEzM1PWp3T5aXNViIiI6OV7pULJzZs3cffuXTg7OwMAvLy8kJ2djVOnTkl9Dhw4gJKSEnh6ekp94uLiUFhYKPWJjY1FvXr1YGNj83JPgIiIiJ6qUkNJbm4uEhMTkZiYCABITU1FYmIi0tLSkJubi2nTpuHo0aO4fv069u/fj169eqFu3brw8/MDADRo0ABdu3ZFcHAwjh8/jvj4eISGhmLgwIFwcXEBAAwePBhqtRpBQUE4f/48oqOjsXz5coSFhVXWaRMREVE5VEIIUVkHP3ToEDp37lymPTAwEKtWrULv3r1x5swZZGdnw8XFBb6+vpg3b55s4uq9e/cQGhqKHTt2wMDAAH379sWKFStgbm4u9UlKSkJISAhOnDgBe3t7jB8/HuHh4S/lHJ9nSed+lV0C6dCUg1squwQioldGpYYSYih53TGUEBFV3Cs1p4SIiIheXwwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIDCVERESkCAwlREREpAgMJURERKQIWgkl2dnZ2tgNERER6TGNQ8miRYsQHR0tLffv3x92dnaoXr06zp49q9XiiIiISH9oHEq+/PJL1KxZEwAQGxuL2NhY7N69G/7+/pg2bZrWCyQiIiL9YKTpBhkZGVIo2blzJ/r37w9fX1/UqlULnp6eWi+QiIiI9IPGIyU2Njb4448/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Z0dERESPU3QouXnzJgYNGoS7d++iWrVqaNeuHY4ePYpq1aoBAD777DMYGBigb9++ePToEfz8/PB///d/0vaGhobYuXMnxo4dCy8vL1StWhWBgYH8jB4iIiIFUgkhRGUXoc+WdO5X2SWQDk05uKXSjs331uutMt9bRLrySs0pISIiotcXQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESkCQwkREREpAkMJERERKQJDCRERESmCokPJggUL0KpVK1hYWMDBwQG9e/dGSkqKrE+nTp2gUqlkX2PGjJH1SUtLQ/fu3VGlShU4ODhg2rRpKCoqepmnQkRERM9hVNkFPMvhw4cREhKCVq1aoaioCB9++CF8fX1x4cIFVK1aVeoXHByMuXPnSstVqlSRvi8uLkb37t3h5OSE3377Denp6QgICICxsTE++eSTl3o+RERE9HSKDiUxMTGy5aioKDg4OODUqVPo0KGD1F6lShU4OTmVu4+9e/fiwoUL2LdvHxwdHdG0aVPMmzcP4eHhiIiIgFqt1uk5EBERUcUo+vLNk+7fvw8AsLW1lbWvW7cO9vb2aNSoEWbMmIH8/HxpXUJCAjw8PODo6Ci1+fn5IScnB+fPn385hRMREdFzKXqk5HElJSWYNGkS2rZti0aNGkntgwcPhqurK1xcXJCUlITw8HCkpKRg27ZtAICMjAxZIAEgLWdkZLy8EyAiIqJnemVCSUhICH7//Xf8+uuvsvZRo0ZJ33t4eMDZ2Rne3t64evUq6tSp87LLJCIiohf0Sly+CQ0Nxc6dO3Hw4EHUqFHjmX09PT0BAFeuXAEAODk5ITMzU9andPlp81CIiIjo5VN0KBFCIDQ0FD/++CMOHDgANze3526TmJgIAHB2dgYAeHl54dy5c7h9+7bUJzY2FpaWlnB3d9dJ3URERKQ5RV++CQkJwfr16/HTTz/BwsJCmgNiZWUFMzMzXL16FevXr0e3bt1gZ2eH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
" alt="Output" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
  device.isMobile,
  COUNT(*) AS device_count
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY device.isMobile
ORDER BY device_count DESC;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-754b9711-ba23-4ca1-afb8-93793bb1f462" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>isMobile</th>
      <th>device_count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>False</td>
      <td>1741</td>
    </tr>
    <tr>
      <th>1</th>
      <td>True</td>
      <td>815</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-754b9711-ba23-4ca1-afb8-93793bb1f462')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-754b9711-ba23-4ca1-afb8-93793bb1f462 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-754b9711-ba23-4ca1-afb8-93793bb1f462');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-e3e752bd-c9d3-40f6-9923-3ab43dda5075">
      <button class="colab-df-quickchart" onclick="quickchart('df-e3e752bd-c9d3-40f6-9923-3ab43dda5075')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-e3e752bd-c9d3-40f6-9923-3ab43dda5075 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The results show that approximately 2/3 of the sessions come from Desktop devices, whereas mobiles and tablets account for the remaining 1/3.<br><br><h3>User Type Analysis</h3><br><br>In order to tell if a user is new or returning, we'll use the totals.newVisits column, where:<br>- 1 = New visitor<br>- NULL = Returning visitor<br><br>I'll also create a metric to calculate conversion rates. This will be:<br>a) the number of transactions per visit (Conversion Rate = transactions/sessions) and<br>b) the revnue of transactions per visit, for the two visitor categories defined above.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
    CASE WHEN
        totals.newVisits = 1 THEN 'new_visitors'
        ELSE 'returning_visitor'
    -- Create a new column
    END AS user_type,
    COUNT(*) AS returning_user_count,
    SUM(totals.transactions) AS total_transactions,
    SUM(totals.transactions) / COUNT(*) AS conversion_rate,
    SUM(totals.transactionRevenue) / 1e6 AS transaction_revenue_visitor,
    SUM(totals.transactionRevenue) / 1e6 / COUNT(*) AS transaction_revenue_per_visitor
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY user_type
ORDER BY transaction_revenue_visitor DESC;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-b9a4c8b5-afa9-457f-a7e6-144be814ccad" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>user_type</th>
      <th>returning_user_count</th>
      <th>total_transactions</th>
      <th>conversion_rate</th>
      <th>transaction_revenue_visitor</th>
      <th>transaction_revenue_per_visitor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>returning_visitor</td>
      <td>684</td>
      <td>34</td>
      <td>0.049708</td>
      <td>7630.46</td>
      <td>11.155643</td>
    </tr>
    <tr>
      <th>1</th>
      <td>new_visitors</td>
      <td>1872</td>
      <td>11</td>
      <td>0.005876</td>
      <td>674.48</td>
      <td>0.360299</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-b9a4c8b5-afa9-457f-a7e6-144be814ccad')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-b9a4c8b5-afa9-457f-a7e6-144be814ccad button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-b9a4c8b5-afa9-457f-a7e6-144be814ccad');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-cb926e27-27f3-42d1-82c9-f7cafb34a1ab">
      <button class="colab-df-quickchart" onclick="quickchart('df-cb926e27-27f3-42d1-82c9-f7cafb34a1ab')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-cb926e27-27f3-42d1-82c9-f7cafb34a1ab button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">So we have 1872 new users and 684 returning users. From the table we can see that returning visitors are significantly more valuable that new visitors because:<br>1. They  make way more purchases (34 transactions vs 11)<br>2. Their conversion rate (\~4.97%) is almost 8.5x higher than new visitors (\~0.59%)<br>3. Returning visitors generated \$7630, compared to \$674 for new visitors.<br>4. And finally, returning visitors spend \$11.16 per session, whereas new visitors spend only \$0.36 per session.<br><br>That's an important conclusion to draw!</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Geographic Analysis</h3></div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

SELECT
    geoNetwork.country,
    COUNT(*) AS country_count,
    SUM(totals.transactionRevenue)  / 1e6 AS revenue_per_country,
    SUM(totals.transactions) / COUNT(*) AS transactions_session,
    SUM(totals.transactionRevenue) / 1e6 / COUNT(*) AS transaction_revenue_per_visitor
FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
GROUP BY geoNetwork.country
ORDER BY transaction_revenue_per_visitor DESC
LIMIT 5;</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-e94f8e8e-6ee5-4b51-8c69-d961f055d9f0" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>country</th>
      <th>country_count</th>
      <th>revenue_per_country</th>
      <th>transactions_session</th>
      <th>transaction_revenue_per_visitor</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>United States</td>
      <td>1287</td>
      <td>8301.95</td>
      <td>0.034188</td>
      <td>6.450622</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Finland</td>
      <td>2</td>
      <td>2.99</td>
      <td>0.500000</td>
      <td>1.495000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>India</td>
      <td>155</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Mexico</td>
      <td>27</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>4</th>
      <td>United Kingdom</td>
      <td>142</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e94f8e8e-6ee5-4b51-8c69-d961f055d9f0')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e94f8e8e-6ee5-4b51-8c69-d961f055d9f0 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e94f8e8e-6ee5-4b51-8c69-d961f055d9f0');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-fa540164-b808-4b13-9982-f70b095e1573">
      <button class="colab-df-quickchart" onclick="quickchart('df-fa540164-b808-4b13-9982-f70b095e1573')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-fa540164-b808-4b13-9982-f70b095e1573 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The results show that the United States is clearly the primary market (both in traffic and revenue). Users from Finland have very high conversion rates, so it's worth investigating as a market. Other countries have decent traffic (like India and UK) but currently not converting.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Bounce</h3><br><br>Bounce rate represents the percentage of visitors who enter the site and then leave ("bounce") rather than continuing to view other pages within the same site. It is calculated by counting the number of single page visits and dividing that by the total visits. It is then represented as a percentage of total visits.</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery bounce_df
--I'll use a Common Table Expression (CTE) to create a temporary result set for bounce data

WITH bounce_table AS (
    SELECT
        trafficSource.medium,
        CASE WHEN totals.pageviews = 1 THEN 1 ELSE 0 END AS is_bounce
    FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
)
SELECT
    medium,
    COUNT(*) AS session_count,
    SUM(is_bounce) AS total_bounce,
    ROUND(SAFE_DIVIDE(SUM(is_bounce), COUNT(*)) * 100, 1) AS bounce_ratio
FROM bounce_table
GROUP BY medium
ORDER BY bounce_ratio DESC;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>bounce_df</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-483fcbce-ca54-474f-9fb5-435e31366dcc" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>medium</th>
      <th>session_count</th>
      <th>total_bounce</th>
      <th>bounce_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>referral</td>
      <td>313</td>
      <td>211</td>
      <td>67.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>organic</td>
      <td>10</td>
      <td>6</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>affiliate</td>
      <td>52</td>
      <td>30</td>
      <td>57.7</td>
    </tr>
    <tr>
      <th>3</th>
      <td>(none)</td>
      <td>2166</td>
      <td>990</td>
      <td>45.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>cpm</td>
      <td>15</td>
      <td>6</td>
      <td>40.0</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-483fcbce-ca54-474f-9fb5-435e31366dcc')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-483fcbce-ca54-474f-9fb5-435e31366dcc button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-483fcbce-ca54-474f-9fb5-435e31366dcc');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-614e81a9-a36b-4d05-b282-d06f617bb51e">
      <button class="colab-df-quickchart" onclick="quickchart('df-614e81a9-a36b-4d05-b282-d06f617bb51e')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-614e81a9-a36b-4d05-b282-d06f617bb51e button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

  <div id="id_6c2e61a6-fc56-4b25-9249-6c1a16cb30ff">
    <style>
      .colab-df-generate {
        background-color: #E8F0FE;
        border: none;
        border-radius: 50%;
        cursor: pointer;
        display: none;
        fill: #1967D2;
        height: 32px;
        padding: 0 0 0 0;
        width: 32px;
      }

      .colab-df-generate:hover {
        background-color: #E2EBFA;
        box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
        fill: #174EA6;
      }

      [theme=dark] .colab-df-generate {
        background-color: #3B4455;
        fill: #D2E3FC;
      }

      [theme=dark] .colab-df-generate:hover {
        background-color: #434B5C;
        box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
        filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
        fill: #FFFFFF;
      }
    </style>
    <button class="colab-df-generate" onclick="generateWithVariable('bounce_df')"
            title="Generate code using this dataframe."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
       width="24px">
    <path d="M7,19H8.4L18.45,9,17,7.55,7,17.6ZM5,21V16.75L18.45,3.32a2,2,0,0,1,2.83,0l1.4,1.43a1.91,1.91,0,0,1,.58,1.4,1.91,1.91,0,0,1-.58,1.4L9.25,21ZM18.45,9,17,7.55Zm-12,3A5.31,5.31,0,0,0,4.9,8.1,5.31,5.31,0,0,0,1,6.5,5.31,5.31,0,0,0,4.9,4.9,5.31,5.31,0,0,0,6.5,1,5.31,5.31,0,0,0,8.1,4.9,5.31,5.31,0,0,0,12,6.5,5.46,5.46,0,0,0,6.5,12Z"/>
  </svg>
    </button>
    <script>
      (() => {
      const buttonEl =
        document.querySelector('#id_6c2e61a6-fc56-4b25-9249-6c1a16cb30ff button.colab-df-generate');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      buttonEl.onclick = () => {
        google.colab.notebook.generateWithVariable('bounce_df');
      }
      })();
    </script>
  </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>plt.figure(figsize=(6, 4))
plt.bar(
    bounce_df['medium'],
    bounce_df['bounce_ratio'],
    color=color_palette[0]
)

plt.xlabel("Traffic Medium")
plt.ylabel("Bounce Ratio (%)")
plt.title("Bounce Ratio by Medium")

# remove bounding box
ax = plt.gca()
for spine in ["top", "right", "left", "bottom"]:
    ax.spines[spine].set_visible(False)

ax.tick_params(left=False, bottom=False)

plt.xticks(rotation=0)
plt.show()</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <img class="output-image" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAhMAAAGJCAYAAAAwtrGcAAAAOnRFWHRTb2Z0d2FyZQBNYXRwbG90bGliIHZlcnNpb24zLjEwLjAsIGh0dHBzOi8vbWF0cGxvdGxpYi5vcmcvlHJYcgAAAAlwSFlzAAAPYQAAD2EBqD+naQAARClJREFUeJzt3Xtcj/f/P/DHu3Q+SwehQqYcSsohRg5NSA7LTMyKHGZhNGy+G5lh8XEcxfhQGDs4bhgmy1kk51OqRRsqh4qQWr1+f/h1fbwVq/dV3u943G+3breu1/W6ruv5vrzVo9f1uq63QgghQERERKQiLXUXQERERNUbwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRVbmYmBgoFApcu3atUvY3ffp0KBQK3Llzp1L2p2n2798PhUKB/fv3S23BwcFwdHRUW01EL8MwQW+Mkl9oz35ZW1ujc+fO2LVrl7rLe6VKflmVfGlra8Pa2hr9+/fH5cuXVd7v7NmzsW3btsorVM06deoEhUKBRo0albl+79690jnctGnTK66OSHPUUHcBRK/ajBkzUL9+fQghkJmZiZiYGPTs2RPbt29Hr1691F3eKzVu3Di0atUKhYWFOHfuHJYvX479+/fjwoULsLW1rfD+Zs+ejf79+6Nv375K7UOGDMHAgQOhp6dXSZW/Ovr6+khJScGJEyfQunVrpXXr16+Hvr4+8vPzq7yOlStXori4uMqPQ6QKhgl64/To0QOenp7SckhICGxsbPDDDz+8cWGiQ4cO6N+/v7TcuHFjjB49GmvXrsXkyZMr7Tja2trQ1tautP29Sg0bNsQ///yDH374QSlM5OfnY+vWrfDz88PmzZurvA4dHZ0qPwaRqniZg9545ubmMDAwQI0aytn64cOH+PTTT1GvXj3o6emhcePGmDdvHp79oN1r165BoVAgJiam1H4VCgWmT58uLZdc509JSUFwcDDMzc1hZmaGoUOH4tGjR6W2//7779G6dWsYGhrCwsICHTt2xO+//67UZ9euXejQoQOMjIxgYmICPz8/XLx4UeVz0aFDBwBAamqqUvu8efPQrl07WFpawsDAAB4eHqWG9RUKBR4+fIg1a9ZIQ//BwcEAXjxnIioqCk2bNoWenh7s7OwQGhqKnJycctd7584dDBgwAKamprC0tMQnn3yiNErg7e0NNze3Mrdt3LgxfH19y3WcwMBA/PTTT0ojA9u3b8ejR48wYMCAMre5ceMGhg0bBhsbG+jp6aFp06ZYvXp1qX5///03+vbtCyMjI1hbW2PChAl48uRJqX7Pz5koa14FUPZ7Mjg4GMbGxkhPT0evXr1gbGyMOnXqIDIyEgBw/vx5dOnSBUZGRnBwcMCGDRvKdV6ISjBM0BsnNzcXd+7cwe3bt3Hx4kWMHj0aeXl5+OCDD6Q+Qgj07t0bCxcuRPfu3bFgwQI0btwYkyZNQlhYmKzjDxgwAA8ePMA333yDAQMGICYmBl999ZVSn6+++gpDhgyBjo4OZsyYga+++gr16tXDH3/8IfVZt24d/Pz8YGxsjDlz5mDq1Km4dOkS3n77bZUnOpZsZ2FhodS+ePFiuLu7Y8aMGZg9ezZq1KiB9957Dzt37lSqR09PDx06dMC6deuwbt06jBo16oXHmj59OkJDQ2FnZ4f58+cjICAA3333Hbp164bCwsJy1TtgwADk5+fjm2++Qc+ePfHtt99i5MiR0vohQ4bg3LlzuHDhgtJ2CQkJuHr1qtK/+csMGjQIt27dUvrFvWHDBnTt2hXW1tal+mdmZqJt27aIjY3FmDFjsHjxYjg5OSEkJASLFi2S+j1+/Bhdu3bFnj17MGbMGHzxxRc4dOhQpY4KlSgqKkKPHj1Qr149zJ07F46OjhgzZgxiYmLQvXt3eHp6Ys6cOTAxMcGHH36ItLS0Sq+BXmOC6A0RHR0tAJT60tPTEzExMUp9t23bJgCImTNnKrX3799fKBQKkZKSIoQQIi0tTQAQ0dHRpY4HQISHh0vL4eHhAoAYNmyYUr9+/foJS0tLaTk5OVloaWmJfv36iaKiIqW+xcXFQgghHjx4IMzNzcWIESOU1mdkZAgzM7NS7c+Li4sTAMTq1avF7du3xc2bN8Xu3buFk5OTUCgU4sSJE0r9Hz16pLRcUFAgmjVrJrp06aLUbmRkJIKCgkodr+Tcp6WlCSGEyMrKErq6uqJbt25Kr3Hp0qVSXS9Tci579+6t1P7xxx8LAOLs2bNCCCFycnKEvr6++Oyzz5T6jRs3ThgZGYm8vLyXHsfb21s0bdpUCCGEp6enCAkJEUIIkZ2dLXR1dcWaNWukc7lx40Zpu5CQEFG7dm1x584dpf0NHDhQmJmZSedz0aJFAoD4+eefpT4PHz4UTk5OAoCIi4uT2oOCgoSDg4O0XHLcZ/sIUfZ7MigoSAAQs2fPltqys7OFgYGBUCgU4scff5Tar1y5Uuq9S/RvODJBb5zIyEjs3bsXe/fuxffff4/OnTtj+PDh2LJli9Tnt99+g7a2NsaNG6e07aeffgohhKy7Pz766COl5Q4dOuDu3bu4f/8+AGDbtm0oLi7GtGnToKWl/F9UoVAAeHoXQU5ODgIDA3Hnzh3pS1tbG23atEFcXFy5ahk2bBisrKxgZ2eH7t27Izc3F+vWrUOrVq2U+hkYGEjfZ2dnIzc3Fx06dMCpU6cq/PoBIDY2FgUFBRg/frzSaxwxYgRMTU2VRjxeJjQ0VGl57NixAJ7++wGAmZkZ+vTpgx9++EG6PFVUVISffvpJurRQXoMGDcKWLVtQUFCATZs2QVtbG/369SvVTwiBzZs3w9/fH0IIpX8fX19f5ObmSuftt99+Q+3atZXmrRgaGiqNrlSm4cOHS9+bm5ujcePGMDIyUrpU07hxY5ibm+PPP/+skhro9cQJmPTGad26tdIEzMDAQLi7u2PMmDHo1asXdHV1cf36ddjZ2cHExERpWxcXFwDA9evXVT6+vb290nLJJYXs7GyYmpoiNTUVWlpaaNKkyQv3kZycDADo0qVLmetNTU3LVcu0adPQoUMH5OXlYevWrfjxxx9LBRgA2LFjB2bOnIkzZ84oXc8vCTcVVXL+GjdurNSuq6uLBg0alPv8Pn/LZsOGDaGlpaV0mefDDz/ETz/9hEOHDqFjx46IjY1FZmYmhgwZUqGaBw4ciIkTJ2LXrl1Yv349evXqVer9AQC3b99GTk4OVqxYgRUrVpS5r6ysLABPz4OTk1Op8/j8eakM+vr6sLKyUmozMzND3bp1Sx3fzMwM2dnZlV4Dvb4YJuiNp6Wlhc6dO2Px4sVITk5G06ZNy73ti36ZFhUVvXCbF93VIJ6Z2PlvSiYCrlu3rsxbOJ+fTPoizZs3h4+PDwCgb9++ePToEUaMGIG3334b9erVAwAcOnQIvXv3RseOHREVFYXatWtDR0cH0dHRGjdRr6x/D19fX9jY2OD7779Hx44d8f3338PW1lZ63eVVu3ZtdOrUCfPnz8eRI0deeAdHyb/NBx98gKCgoDL7uLq6VujYZanoe+9F77vKeD8SMUwQAfjnn38AAHl5eQAABwcHxMbG4sGDB0p/fV65ckVaD/xvVOH5OxDkjFw0bNgQxcXFuHTpElq0aPHCPgBgbW1d4V+KLxMREYGtW7di1qxZWL58OQBg8+bN0NfXx549e5SeExEdHV1q+/KOVJScv6SkJDRo0EBqLygoQFpaWrlfU3JyMurXry8tp6SkoLi4WOmuB21tbQwaNAgxMTGYM2cOtm3bhhEjRqh0q+qgQYMwfPhwmJubo2fPnmX2sbKygomJCYqKiv71dTg4OODChQsQQiidu6SkpH+tpSree0Sq4pwJeuMVFhbi999/h66urnQZo2fPnigqKsLSpUuV+i5cuBAKhQI9evQA8PRyQq1atXDw4EGlflFRUSrX07dvX2hpaWHGjBmlHlJU8teir68vTE1NMXv27DLvfLh9+7ZKx27YsCECAgIQExODjIwMAE9/GSsUCqW/eK9du1bmky6NjIzKdWunj48PdHV18e233yr9Bbxq1Srk5ubCz8+vXPWW3NpYYsmSJQAg/fuUGDJkCLKzszFq1KhSd+5URP/+/REeHo6oqCjo6uqW2UdbWxsBAQHYvHlzqbtIAOV/m549e+LmzZtKt9k+evTohZdHnuXg4ABtbe1Kfe8RqYojE/TG2bVrlzTCkJWVhQ0bNiA5ORmff/65NNfA398fnTt3xhdffIFr167Bzc0Nv//+O3755ReMHz9eGhkAnk5qi4iIwPDhw+Hp6YmDBw/i6tWrKtfn5OSEL774Al9//TU6dOiAd999F3p6ekhISICdnR2++eYbmJqaYtmyZRgyZAhatmyJgQMHwsrKCunp6di5cyfat29fKgiV16RJk/Dzzz9j0aJFiIiIgJ+fHxYsWIDu3btj0KBByMrKQmRkJJycnHDu3DmlbT08PBAbG4sFCxbAzs4O9evXR5s2bUodw8rKClOmTMFXX32F7t27o3fv3khKSkJUVBRatWpV7l/2aWlp6N27N7p3745jx47h+++/x6BBg0o9W8Ld3R3NmjXDxo0b4eLigpYtW6p0bszMzJSeHfIiERERiIuLQ5s2bTBixAg0adIE9+7dw6lTpxAbG4t79+4BeDrhdOnSpfjwww+RmJiI2rVrY926dTA0NCxXLe+99x6WLFkChUKBhg0bYseOHdJ8DKJXSm33kRC9YmXdGqqvry9atGghli1bJt12WeLBgwdiwoQJws7OTujo6IhGjRqJ//znP6X6PXr0SISEhAgzMzNhYmIiBgwYILKysl54a+jt27fLrKvktskSq1evFu7u7kJPT09YWFgIb29vsXfvXqU+cXFxwtfXV5iZmQl9fX3RsGFDERwcLE6ePPnSc1HW7YzP6tSpkzA1NRU5OTlCCCFWrVolGjVqJPT09ISzs7OIjo6WXs+zrly5Ijp27CgMDAwEAOk20Re9xqVLlwpnZ2eho6MjbGxsxOjRo0V2dvZLaxfif+fy0qVLon///sLExERYWFiIMWPGiMePH5e5zdy5c0vdHvlvnr019EVedC4zMzNFaGioqFevntDR0RG2traia9euYsWKFUr9rl+/Lnr37i0MDQ1FrVq1xCeffCJ27979r7eGCiHE7du3RUBAgDA0NBQWFhZi1KhR4sKFC2XeGmpkZFTu1+fg4CD8/Pxe+rqJnqUQgrNsiOj1t3jxYkyYMAHXrl0rdUcNEcnDMEFErz0hBNzc3GBpaVnuZ3AQUflxzgQRvbYePnyIX3/9FXFxcTh//jx++eUXdZdE9FriyAQRvbauXbuG+vXrw9zcHB9//DFmzZql7pKIXksME0RERCQLnzNBREREsjBMEBERkSxqDROOjo5QKBSlvko+CTA/Px+hoaGwtLSEsbExAgICkJmZqc6SiYiI6DlqnTNx+/ZtpUf0XrhwAe+88w7i4uLQqVMnjB49Gjt37kRMTAzMzMwwZswYaGlp4ciRI+oqmYiIiJ6jURMwx48fjx07diA5ORn379+HlZUVNmzYgP79+wN4+iFLLi4uOHbsGNq2bavmaomIiAjQoDkTBQUF+P777zFs2DAoFAokJiaisLBQ6VP3nJ2dYW9vj2PHjqmxUiIiInqWxoSJbdu2IScnB8HBwQCAjIwM6OrqwtzcXKmfjY2N9GmGREREpH4aEyZWrVqFHj16wM7OTt2lEBERUQVoxOO0r1+/jtjYWGzZskVqs7W1RUFBAXJycpRGJzIzM2Fra6uGKomIiKgsGjEyER0dDWtra/j5+UltHh4e0NHRwb59+6S2pKQkpKenw8vLSx1lEhERURnUPjJRXFyM6OhoBAUFoUaN/5VjZmaGkJAQhIWFoWbNmjA1NcXYsWPh5eXFOzmIiIg0iNrDRGxsLNLT0zFs2LBS6xYuXAgtLS0EBATgyZMn8PX1RVRUlBqqJCIiohfRqOdMEBERUfWjEXMmiIiIqPpimCAiIiJZGCaIiIhIFoYJIiIikkXtd3NUV/M791d3CRrp07hN6i6BiIheMY5MEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsqg9TNy4cQMffPABLC0tYWBggObNm+PkyZPSeiEEpk2bhtq1a8PAwAA+Pj5ITk5WY8VERET0LLWGiezsbLRv3x46OjrYtWsXLl26hPnz58PCwkLqM3fuXHz77bdYvnw5jh8/DiMjI/j6+iI/P1+NlRMREVGJGuo8+Jw5c1CvXj1ER0dLbfXr15e+F0Jg0aJF+PLLL9GnTx8AwNq1a2FjY4Nt27Zh4MCBr7xmIiIiUqbWkYlff/0Vnp6eeO+992BtbQ13d3esXLlSWp+WloaMjAz4+PhIbWZmZmjTpg2OHTumjpKJiIjoOWodmfjzzz+xbNkyhIWF4f/+7/+QkJCAcePGQVdXF0FBQcjIyAAA2NjYKG1nY2MjraPX0/zO/dVdgsb6NG6TuksgIlKi1jBRXFwMT09PzJ49GwDg7u6OCxcuYPny5QgKClJnaURERFROar3MUbt2bTRp0kSpzcXFBenp6QAAW1tbAEBmZqZSn8zMTGkdERERqZdaw0T79u2RlJSk1Hb16lU4ODgAeDoZ09bWFvv27ZPW379/H8ePH4eXl9crrZWIiIjKptbLHBMmTEC7du0we/ZsDBgwACdOnMCKFSuwYsUKAIBCocD48eMxc+ZMNGrUCPXr18fUqVNhZ2eHvn37qrN0IiIi+v/UGiZatWqFrVu3YsqUKZgxYwbq16+PRYsWYfDgwVKfyZMn4+HDhxg5ciRycnLw9ttvY/fu3dDX11dj5URERFRCIYQQ6i6iOuLdBmWrrDsNeH5fjHdzEJGmUfvjtImIiKh6Y5ggIiIiWRgmiIiISBa1TsAkIvXgnJQX45wUoorjyAQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCSLWsPE9OnToVAolL6cnZ2l9fn5+QgNDYWlpSWMjY0REBCAzMxMNVZMREREz1P7yETTpk1x69Yt6evw4cPSugkTJmD79u3YuHEjDhw4gJs3b+Ldd99VY7VERET0vBpqL6BGDdja2pZqz83NxapVq7BhwwZ06dIFABAdHQ0XFxfEx8ejbdu2r7pUIiIiKoPaRyaSk5NhZ2eHBg0aYPDgwUhPTwcAJCYmorCwED4+PlJfZ2dn2Nvb49ixY+oql4iIiJ6j1jDRpk0bxMTEYPfu3Vi2bBnS0tLQoUMHPHjwABkZGdDV1YW5ubnSNjY2NsjIyFBPwURERFSKWi9z9OjRQ/re1dUVbdq0gYODA37++WcYGBiosTIiIiIqL7Vf5niWubk53nrrLaSkpMDW1hYFBQXIyclR6pOZmVnmHAsiIiJSD40KE3l5eUhNTUXt2rXh4eEBHR0d7Nu3T1qflJSE9PR0eHl5qbFKIiIiepZaL3NMnDgR/v7+cHBwwM2bNxEeHg5tbW0EBgbCzMwMISEhCAsLQ82aNWFqaoqxY8fCy8uLd3IQERFpELWGib///huBgYG4e/curKys8PbbbyM+Ph5WVlYAgIULF0JLSwsBAQF48uQJfH19ERUVpc6SiYiI6Dkqh4nCwkJkZGTg0aNHsLKyQs2aNSu8jx9//PGl6/X19REZGYnIyEhVyyQiIqIqVqE5Ew8ePMCyZcvg7e0NU1NTODo6wsXFBVZWVnBwcMCIESOQkJBQVbUSERGRBip3mFiwYAEcHR0RHR0NHx8fbNu2DWfOnMHVq1dx7NgxhIeH459//kG3bt3QvXt3JCcnV2XdREREpCHKfZkjISEBBw8eRNOmTctc37p1awwbNgzLly9HdHQ0Dh06hEaNGlVaoURERKSZyh0mfvjhh3L109PTw0cffaRyQURERFS9yL6bo7CwEFevXkVRUREaN24MPT29yqiLiIiIqglZD606dOgQHB0d0blzZ3Tq1An16tXD7t27K6s2IiIiqgYqFCaKi4uVlsePH4/169cjKysL9+7dw8yZMzF69OhKLZCIiIg0W4XCRJs2bXDq1ClpuaCgAPb29tKyvb098vPzK686IiIi0ngVmjOxdOlSDB8+HN7e3pg5cybCw8Ph4eGBxo0bo7CwEFeuXMGSJUuqqlYiIiLSQBUKE23atEFCQgLmzp0LDw8PzJ07F0lJSTh+/DiKiorQqlUr1KlTp6pqJSIiIg1U4bs5tLW1MWXKFAwYMAAfffQR1qxZgyVLlsDOzq4q6iMiIiINV+G7OS5evIjNmzejqKgIe/fuRe/evdGhQwd+ABcREdEbqkIjEwsWLMCXX34JV1dXJCcnIyIiAiNGjICfnx/CwsKwbt06rFixAs2bN6+qeomINN78zv3VXYLG+jRuk7pLoCpQoZGJuXPnYufOnYiPj8epU6ewYMECAECtWrWwdu1azJgxAwMGDKiSQomIiEgzVShMCCGgpfV0E21tbQghlNa/8847OH36dOVVR0RERBqvQpc5Jk2ahJ49e8LNzQ1Xr17F7NmzS/XR19evtOKIiIhI81UoTEycOBG+vr64cuUKmjdvDmdn56qqi4iIiKqJCt8a2rx5c06wJCIiIkm550xERETg0aNH5ep7/Phx7Ny5U+WiiIiIqPood5i4dOkSHBwc8PHHH2PXrl24ffu2tO6ff/7BuXPnEBUVhXbt2uH999+HiYlJlRRMREREmqXclznWrl2Ls2fPYunSpRg0aBDu378PbW1t6OnpSSMW7u7uGD58OIKDgzkRk4iI6A1RoTkTbm5uWLlyJb777jucO3cO169fx+PHj1GrVi20aNECtWrVqqo6iYiISENVeAImAGhpaaFFixZo0aJFJZdDRERE1U2FP5uDiIiI6FkME0RERCQLwwQRERHJwjBBREREssgOE3///Tf+/vvvyqiFiIiIqiGVwkRxcTFmzJgBMzMzODg4wMHBAebm5vj6669RXFxc2TUSERGRBlPp1tAvvvgCq1atQkREBNq3bw8AOHz4MKZPn478/HzMmjWrUoskIiIizaVSmFizZg3++9//onfv3lKbq6sr6tSpg48//phhgoiI6A2i0mWOe/fulfnx487Ozrh3757sooiIiKj6UClMuLm5YenSpaXaly5dCjc3N9lFERERUfWhUpiYO3cuVq9ejSZNmiAkJAQhISFo0qQJYmJi8J///EelQiIiIqBQKDB+/HipLT8/H6GhobC0tISxsTECAgKQmZmp0v6JiIioaqgUJry9vXH16lX069cPOTk5yMnJwbvvvoukpCR06NChwvtLSEjAd999B1dXV6X2CRMmYPv27di4cSMOHDiAmzdv4t1331WlZCIiIqoiKk3ABAA7O7tKmWiZl5eHwYMHY+XKlZg5c6bUnpubi1WrVmHDhg3o0qULACA6OhouLi6Ij49H27ZtZR+biIiI5Ct3mDh37hyaNWsGLS0tnDt37qV9nx9heJnQ0FD4+fnBx8dHKUwkJiaisLAQPj4+UpuzszPs7e1x7NgxhgkiIiINUe4w0aJFC2RkZMDa2hotWrSAQqGAEKJUP4VCgaKionLt88cff8SpU6eQkJBQal1GRgZ0dXVhbm6u1G5jY4OMjIzylk1ERK+Z+Z37q7sEjfVp3Ca1HLfcYSItLQ1WVlbS93L99ddf+OSTT7B3717o6+vL3h8RERGpR7nDhIODg/T99evX0a5dO9Soobz5P//8g6NHjyr1fZHExERkZWWhZcuWUltRUREOHjyIpUuXYs+ePSgoKEBOTo7S6ERmZiZsbW3LWzYRERFVMZXu5ujcuXOZD6fKzc1F586dy7WPrl274vz58zhz5oz05enpicGDB0vf6+joYN++fdI2SUlJSE9Ph5eXlyplExERURVQ6W4OIQQUCkWp9rt378LIyKhc+zAxMUGzZs2U2oyMjGBpaSm1h4SEICwsDDVr1oSpqSnGjh0LLy8vTr4kIiLSIBUKEyXPeFAoFAgODoaenp60rqioCOfOnUO7du0qrbiFCxdCS0sLAQEBePLkCXx9fREVFVVp+yciIiL5KhQmzMzMADwdmTAxMYGBgYG0TldXF23btsWIESNULmb//v1Ky/r6+oiMjERkZKTK+yQiIqKqVaEwER0dDQBwdHTExIkTy31Jg4iIiF5fKs2ZCA8Pr+w6iIiIqJpS+XHamzZtws8//4z09HQUFBQorTt16pTswoiIiKh6UOnW0G+//RZDhw6FjY0NTp8+jdatW8PS0hJ//vknevToUdk1EhERkQZTKUxERUVhxYoVWLJkCXR1dTF58mTs3bsX48aNQ25ubmXXSERERBpMpTCRnp4u3QJqYGCABw8eAACGDBmCH374ofKqIyIiIo2nUpiwtbWVnoBpb2+P+Ph4AE8/s6OsD/8iIiKi15dKYaJLly749ddfAQBDhw7FhAkT8M477+D9999Hv379KrVAIiIi0mwq3c2xYsUKFBcXAwBCQ0NhaWmJo0ePonfv3hg1alSlFkhERESaTaUwoaWlBS2t/w1qDBw4EAMHDgQA3LhxA3Xq1Kmc6oiIiEjjqXSZoywZGRkYO3YsGjVqVFm7JCIiomqgQmEiOzsbgYGBqFWrFuzs7PDtt9+iuLgY06ZNQ4MGDZCQkCA9cpuIiIjeDBW6zPH555/j6NGjCA4Oxp49ezBhwgTs3r0bWlpa+OOPP/jR4ERERG+gCo1M7Nq1C9HR0Zg3bx62b98OIQRatGiBHTt2MEgQERG9oSoUJm7evAkXFxcATz85VF9fHx988EGVFEZERETVQ4XChBACNWr878qItrY2DAwMKr0oIiIiqj4qNGdCCIGuXbtKgeLx48fw9/eHrq6uUj9+aigREdGbo0JhIjw8XGm5T58+lVoMERERVT+ywgQRERFRpT20ioiIiN5MDBNEREQkC8MEERERycIwQURERLLIDhP5+fmVUQcRERFVUyqFieLiYnz99deoU6cOjI2N8eeffwIApk6dilWrVlVqgURERKTZVAoTM2fORExMDObOnav0wKpmzZrhv//9b6UVR0RERJpPpTCxdu1arFixAoMHD4a2trbU7ubmhitXrlRacURERKT5VAoTN27cgJOTU6n24uJiFBYWyi6KiIiIqg+VwkSTJk1w6NChUu2bNm2Cu7u77KKIiIio+qjQ47RLTJs2DUFBQbhx4waKi4uxZcsWJCUlYe3atdixY0dl10hEREQaTKWRiT59+mD79u2IjY2FkZERpk2bhsuXL2P79u145513KrtGIiIi0mAqjUwAQIcOHbB3797KrIWIiIiqIZVGJhISEnD8+PFS7cePH8fJkyfLvZ9ly5bB1dUVpqamMDU1hZeXF3bt2iWtz8/PR2hoKCwtLWFsbIyAgABkZmaqUjIRERFVEZXCRGhoKP76669S7Tdu3EBoaGi591O3bl1EREQgMTERJ0+eRJcuXdCnTx9cvHgRADBhwgRs374dGzduxIEDB3Dz5k28++67qpRMREREVUSlyxyXLl1Cy5YtS7W7u7vj0qVL5d6Pv7+/0vKsWbOwbNkyxMfHo27duli1ahU2bNiALl26AACio6Ph4uKC+Ph4tG3bVpXSiYiIqJKpNDKhp6dX5uWGW7duoUYN1aZhFBUV4ccff8TDhw/h5eWFxMREFBYWwsfHR+rj7OwMe3t7HDt2TKVjEBERUeVTKUx069YNU6ZMQW5urtSWk5OD//u//6vw3Rznz5+HsbEx9PT08NFHH2Hr1q1o0qQJMjIyoKurC3Nzc6X+NjY2yMjIUKVsIiIiqgIqDSPMmzcPHTt2hIODg/SQqjNnzsDGxgbr1q2r0L4aN26MM2fOIDc3F5s2bUJQUBAOHDigSllERESkBiqFiTp16uDcuXNYv349zp49CwMDAwwdOhSBgYHQ0dGp0L50dXWlR3N7eHggISEBixcvxvvvv4+CggLk5OQojU5kZmbC1tZWlbKJiIioCqj8nAkjIyOMHDmyMmsB8PTzPZ48eQIPDw/o6Ohg3759CAgIAAAkJSUhPT0dXl5elX5cIiIiUo3KYSI5ORlxcXHIyspCcXGx0rpp06aVax9TpkxBjx49YG9vjwcPHmDDhg3Yv38/9uzZAzMzM4SEhCAsLAw1a9aEqakpxo4dCy8vL97JQUREpEFUChMrV67E6NGjUatWLdja2kKhUEjrFApFucNEVlYWPvzwQ9y6dQtmZmZwdXXFnj17pEmcCxcuhJaWFgICAvDkyRP4+voiKipKlZKJiIioiqgUJmbOnIlZs2bhs88+k3XwVatWvXS9vr4+IiMjERkZKes4REREVHVUujU0Ozsb7733XmXXQkRERNWQSmHivffew++//17ZtRAREVE1pNJlDicnJ0ydOhXx8fFo3rx5qdtBx40bVynFERERkeZTKUysWLECxsbGOHDgQKkHTCkUCoYJIiKiN4hKYSItLa2y6yAiIqJqSqU5E0REREQlVBqZGDZs2EvXr169WqViiIiIqPpRKUxkZ2crLRcWFuLChQvIyclBly5dKqUwIiIiqh5UChNbt24t1VZcXIzRo0ejYcOGsosiIiKi6qPS5kxoaWkhLCwMCxcurKxdEhERUTVQqRMwU1NT8c8//1TmLomIiEjDqXSZIywsTGlZCIFbt25h586dCAoKqpTCiIiIqHpQKUycPn1aaVlLSwtWVlaYP3/+v97pQURERK8XlcJEXFxcZddBRERE1ZRKYaLE7du3kZSUBABo3LgxrKysKqUoIiIiqj5UmoD58OFDDBs2DLVr10bHjh3RsWNH2NnZISQkBI8eParsGomIiEiDqRQmwsLCcODAAWzfvh05OTnIycnBL7/8ggMHDuDTTz+t7BqJiIhIg6l0mWPz5s3YtGkTOnXqJLX17NkTBgYGGDBgAJYtW1ZZ9REREZGGU2lk4tGjR7CxsSnVbm1tzcscREREbxiVwoSXlxfCw8ORn58vtT1+/BhfffUVvLy8Kq04IiIi0nwqXeZYvHgxfH19UbduXbi5uQEAzp49C319fezZs6dSCyQiIiLNplKYaNasGZKTk7F+/XpcuXIFABAYGIjBgwfDwMCgUgskIiIizabycyYMDQ0xYsSIyqyFiIiIqiGVwsTdu3dhaWkJAPjrr7+wcuVKPH78GP7+/ujYsWOlFkhERESarUITMM+fPw9HR0dYW1vD2dkZZ86cQatWrbBw4UKsWLECXbp0wbZt26qoVCIiItJEFQoTkydPRvPmzXHw4EF06tQJvXr1gp+fH3Jzc5GdnY1Ro0YhIiKiqmolIiIiDVShyxwJCQn4448/4OrqCjc3N6xYsQIff/wxtLSeZpKxY8eibdu2VVIoERERaaYKjUzcu3cPtra2AABjY2MYGRnBwsJCWm9hYYEHDx5UboVERESk0Sr80CqFQvHSZSIiInqzVPhujuDgYOjp6QEA8vPz8dFHH8HIyAgA8OTJk8qtjoiIiDRehcJEUFCQ0vIHH3xQqs+HH34oryIiIiKqVioUJqKjo6uqDiIiIqqmVPqgLyIiIqISag0T33zzDVq1agUTExNYW1ujb9++SEpKUuqTn5+P0NBQWFpawtjYGAEBAcjMzFRTxURERPQ8tYaJAwcOIDQ0FPHx8di7dy8KCwvRrVs3PHz4UOozYcIEbN++HRs3bsSBAwdw8+ZNvPvuu2qsmoiIiJ6l8gd9VYbdu3crLcfExMDa2hqJiYno2LEjcnNzsWrVKmzYsAFdunQB8HTehouLC+Lj4/mALCIiIg2gUXMmcnNzAQA1a9YEACQmJqKwsBA+Pj5SH2dnZ9jb2+PYsWNqqZGIiIiUaUyYKC4uxvjx49G+fXs0a9YMAJCRkQFdXV2Ym5sr9bWxsUFGRoYaqiQiIqLnqfUyx7NCQ0Nx4cIFHD58WN2lEBERUQVoxMjEmDFjsGPHDsTFxaFu3bpSu62tLQoKCpCTk6PUPzMzU/qMECIiIlIvtYYJIQTGjBmDrVu34o8//kD9+vWV1nt4eEBHRwf79u2T2pKSkpCeng4vL69XXS4RERGVQa2XOUJDQ7Fhwwb88ssvMDExkeZBmJmZwcDAAGZmZggJCUFYWBhq1qwJU1NTjB07Fl5eXryTg4iISEOoNUwsW7YMANCpUyel9ujoaAQHBwMAFi5cCC0tLQQEBODJkyfw9fVFVFTUK66UiIiIXkStYUII8a999PX1ERkZicjIyFdQEREREVWURkzAJCIiouqLYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBa1homDBw/C398fdnZ2UCgU2LZtm9J6IQSmTZuG2rVrw8DAAD4+PkhOTlZPsURERFQmtYaJhw8fws3NDZGRkWWunzt3Lr799lssX74cx48fh5GREXx9fZGfn/+KKyUiIqIXqaHOg/fo0QM9evQoc50QAosWLcKXX36JPn36AADWrl0LGxsbbNu2DQMHDnyVpRIREdELaOycibS0NGRkZMDHx0dqMzMzQ5s2bXDs2DE1VkZERETP0tgwkZGRAQCwsbFRarexsZHWERERkfppbJggIiKi6kFjw4StrS0AIDMzU6k9MzNTWkdERETqp7Fhon79+rC1tcW+ffuktvv37+P48ePw8vJSY2VERET0LLXezZGXl4eUlBRpOS0tDWfOnEHNmjVhb2+P8ePHY+bMmWjUqBHq16+PqVOnws7ODn379lVf0URERKRErWHi5MmT6Ny5s7QcFhYGAAgKCkJMTAwmT56Mhw8fYuTIkcjJycHbb7+N3bt3Q19fX10lExER0XPUGiY6deoEIcQL1ysUCsyYMQMzZsx4hVURERFRRWjsnAkiIiKqHhgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWRgmiIiISBaGCSIiIpKFYYKIiIhkYZggIiIiWapFmIiMjISjoyP09fXRpk0bnDhxQt0lERER0f+n8WHip59+QlhYGMLDw3Hq1Cm4ubnB19cXWVlZ6i6NiIiIUA3CxIIFCzBixAgMHToUTZo0wfLly2FoaIjVq1eruzQiIiKChoeJgoICJCYmwsfHR2rT0tKCj48Pjh07psbKiIiIqIRCCCHUXcSL3Lx5E3Xq1MHRo0fh5eUltU+ePBkHDhzA8ePH1VgdERERARo+MkFERESaT6PDRK1ataCtrY3MzEyl9szMTNja2qqpKiIiInqWRocJXV1deHh4YN++fVJbcXEx9u3bp3TZg4iIiNSnhroL+DdhYWEICgqCp6cnWrdujUWLFuHhw4cYOnSouksjIiIiVIMw8f777+P27duYNm0aMjIy0KJFC+zevRs2NjbqLo2IiIig4XdzEBERkebT6DkTREREpPkYJoiIiEgWhgkiIiKShWFCQwkhMHLkSNSsWRMKhQJnzpx55TXExMTA3Nz8lR/3dTJ9+nS0aNFC3WVUqStXrqBt27bQ19eXXuvzbdeuXVN6H+/fvx8KhQI5OTkA+F4jqu4YJjTU7t27ERMTgx07duDWrVto1qyZuksiFUycOFHpOSmvo/DwcBgZGSEpKUl6rc+31atX76Xv4/fffx9Xr16t0HEdHR2xaNEiueVrnLt378La2hrXrl1TdylKBg4ciPnz56u7DNJQGn9r6OuooKAAurq6L+2TmpqK2rVro127diofRwiBoqIi1Kih/M9cnuO/rl50TqqKsbExjI2NX8mx1CU1NRV+fn5wcHB4advLnlprYGAAAwODKq2zupg1axb69OkDR0dHdZei5Msvv0THjh0xfPhwmJmZqbsc0jSCqpy3t7cIDQ0Vn3zyibC0tBSdOnUS58+fF927dxdGRkbC2tpafPDBB+L27dtCCCGCgoIEAOnLwcFBCCFEUVGRmD17tnB0dBT6+vrC1dVVbNy4UTpOXFycACB+++030bJlS6GjoyPi4uLKPL4QQsyfP180a9ZMGBoairp164rRo0eLBw8eSPuLjo4WZmZmr+w8qSo/P1+MHTtWWFlZCT09PdG+fXtx4sQJIcSLz8n9+/fFoEGDhKGhobC1tRULFiwQ3t7e4pNPPpH2u3btWuHh4SGMjY2FjY2NCAwMFJmZmdL6kn3HxsYKDw8PYWBgILy8vMSVK1ekPuHh4cLNzU2p3lWrVokmTZoIXV1dYWtrK0JDQ6v0/Mi1a9cu0b59e2FmZiZq1qwp/Pz8REpKihBCKL1PAYjw8PAy29LS0gQAcfr0aSHE/85ddna2EKL0ey0lJUX07t1bWFtbCyMjI+Hp6Sn27t0rrff29i51nBKHDh0Sb7/9ttDX1xd169YVY8eOFXl5eVV+nirDw4cPhampqTh27Ji6SymTp6enWLp0qbrLqDJFRUVizpw5omHDhkJXV1fUq1dPzJw5U3r//vDDD8LLy0vo6emJpk2biv3790vblrynd+/eLVq0aCH09fVF586dRWZmpvjtt9+Es7OzMDExEYGBgeLhw4dqfJVVg2HiFfD29hbGxsZi0qRJ4sqVKyI+Pl5YWVmJKVOmiMuXL4tTp06Jd955R3Tu3FkIIUROTo6YMWOGqFu3rrh165bIysoSQggxc+ZM4ezsLHbv3i1SU1NFdHS00NPTk97QJW9mV1dX8fvvv4uUlBRx9+7dUscv+WW3cOFC8ccff4i0tDSxb98+0bhxYzF69Gip7uoSJsaNGyfs7OzEb7/9Ji5evCiCgoKEhYWFuHv37gvPyfDhw4WDg4OIjY0V58+fF/369RMmJiZKYWLVqlXit99+E6mpqeLYsWPCy8tL9OjRQ1pfsu82bdqI/fv3i4sXL4oOHTqIdu3aSX2eDxNRUVFCX19fLFq0SCQlJYkTJ06IhQsXvoKzpLpNmzaJzZs3i+TkZHH69Gnh7+8vmjdvLoqKisStW7dE06ZNxaeffipu3bolHjx4UGZbRcPEmTNnxPLly8X58+fF1atXxZdffin09fXF9evXhRBC3L17V9StW1fMmDFD3Lp1S9y6dUsI8TSEGBkZiYULF4qrV6+KI0eOCHd3dxEcHPwqT5nKNm7cKKysrKTl8gRWIZ6+rxo0aCB0dHTEW2+9JdauXau0HoBYuXKl6Nu3rzAwMBBOTk7il19+Uerzsj9wSnz11Vfi7bffruRXrTkmT54sLCwsRExMjEhJSRGHDh0SK1eulN6/devWFZs2bRKXLl0Sw4cPFyYmJuLOnTtCiP/9W7Vt21YcPnxYnDp1Sjg5OQlvb2/RrVs3cerUKXHw4EFhaWkpIiIi1PxKKx/DxCvg7e0t3N3dpeWvv/5adOvWTanPX3/9JQCIpKQkIcTTX/QlIxJCPP3r29DQUBw9elRpu5CQEBEYGCiE+N+bedu2bS89/ots3LhRWFpaSsvVIUzk5eUJHR0dsX79eqmtoKBA2NnZiblz55Z5Tu7fvy90dHSURnVycnKEoaGhUph4XkJCggAgjd48+4O+xM6dOwUA8fjxYyFE6TBhZ2cnvvjiC7kvW61u374tAIjz588LIYRwc3MT4eHhSn2eb6tomChL06ZNxZIlS6RlBweHUkEsJCREjBw5Uqnt0KFDQktLS/o30WTjxo0T3bt3l5bLE1i3bNkidHR0RGRkpEhKShLz588X2tra4o8//pD6lPwi3LBhg0hOThbjxo0TxsbG4u7du0IIIbKzs1/6B06JXbt2CV1dXZGfn1/FZ+LVu3//vtDT0xMrV64sta7k/ftsCCgsLBR169YVc+bMEUKU/fPgm2++EQBEamqq1DZq1Cjh6+tbha9EPTgB8xXx8PCQvj979izi4uKk6+nGxsZwdnYG8PRac1lSUlLw6NEjvPPOO0rbrV27ttQ2np6eLz1+idjYWHTt2hV16tSBiYkJhgwZgrt37+LRo0dyXuorlZqaisLCQrRv315q09HRQevWrXH58mWp7dlz8ueff6KwsBCtW7eW2szMzNC4cWOlfScmJsLf3x/29vYwMTGBt7c3ACA9PV2pn6urq/R97dq1AQBZWVmlas3KysLNmzfRtWtXVV6q2iQnJyMwMBANGjSAqampdC3/+fNQmfLy8jBx4kS4uLjA3NwcxsbGuHz58r8e8+zZs4iJiVH6P+Lr64vi4mKkpaVVWb2V5fr167CzsyvVPmvWLHh7e6NJkyb4/PPPcfToUeTn5wMA5s2bh+DgYHz88cd46623EBYWhnfffRfz5s1T2kdwcDACAwPh5OSE2bNnIy8vDydOnAAALF26FO7u7pg9ezacnZ3h7u6O1atXIy4uTmlirJ2dHQoKCpCRkVGFZ0E9Ll++jCdPnrz0/+ezHzBZo0YNeHp6Kv2cAZR/HtjY2MDQ0BANGjRQaivr50N1xwmYr4iRkZH0fV5eHvz9/TFnzpxS/Up+GT0vLy8PALBz507UqVNHaZ2ent4Lj/WitmvXrqFXr14YPXo0Zs2ahZo1a+Lw4cMICQlBQUEBDA0Ny/fCqomyzsnLPHz4EL6+vvD19cX69ethZWWF9PR0+Pr6oqCgQKmvjo6O9L1CoQDw9NNtn1ddJxj6+/vDwcEBK1euhJ2dHYqLi9GsWbNS56EyTZw4EXv37sW8efPg5OQEAwMD9O/f/1+PmZeXh1GjRmHcuHGl1tnb21dVuZXm8ePH0NfXL9X+osBqb2+Py5cvY+TIkUr927dvj8WLF79wH0ZGRjA1NZV+qT37B87zUlNT8dZbbwH433u4Ov3BUV6V9f/z+Z8Hzy6XtJX186G6Y5hQg5YtW2Lz5s1wdHQs910FTZo0gZ6eHtLT06W/kOVITExEcXEx5s+fDy2tpwNUP//8s+z9vmoNGzaErq4ujhw5It05UFhYiISEBIwfP77MbRo0aAAdHR0kJCRIv2Byc3Nx9epVdOzYEcDT5yTcvXsXERERqFevHgDg5MmTsmo1MTGBo6Mj9u3bh86dO8va16ty9+5dJCUlYeXKlejQoQMA4PDhw1V+3CNHjiA4OBj9+vUD8DQkPH+rpK6uLoqKipTaWrZsiUuXLsHJyanKa6wKtWrVQnZ2dqn28gbWl3nZL7Xy/oFz7949AICVlVWFjl0dNGrUCAYGBti3bx+GDx9eZp/4+HjpZ8Q///yDxMREjBkz5lWWqbF4mUMNQkNDce/ePQQGBiIhIQGpqanYs2cPhg4dWuqHYwkTExNMnDgREyZMwJo1a5CamopTp05hyZIlWLNmTYVrcHJyQmFhIZYsWYI///wT69atw/Lly+W+tFfOyMgIo0ePxqRJk7B7925cunQJI0aMwKNHjxASElLmNiYmJggKCsKkSZMQFxeHixcvIiQkBFpaWtIPant7e+jq6krn59dff8XXX38tu97p06dj/vz5+Pbbb5GcnCz9G2oqCwsLWFpaYsWKFUhJScEff/yBsLCwKj9uo0aNsGXLFpw5cwZnz57FoEGDSv3ydHR0xMGDB3Hjxg3cuXMHAPDZZ5/h6NGjGDNmDM6cOYPk5GT88ssv1eYHvru7Oy5dulShbVxcXHDkyBGltiNHjqBJkybl3kfLli1x8eJFODo6wsnJSenr2VG9CxcuoG7duqhVq1aFaqwO9PX18dlnn2Hy5MnS5eP4+HisWrVK6hMZGYmtW7fiypUrCA0NRXZ2NoYNG6bGqjUHw4Qa2NnZ4ciRIygqKkK3bt3QvHlzjB8/Hubm5tIoQVm+/vprTJ06Fd988w1cXFzQvXt37Ny5E/Xr169wDW5ubliwYAHmzJmDZs2aYf369fjmm2/kvCy1iYiIQEBAAIYMGYKWLVsiJSUFe/bsgYWFxQu3WbBgAby8vNCrVy/4+Pigffv2cHFxkYaYraysEBMTg40bN6JJkyaIiIgodQ1aFUFBQVi0aBGioqLQtGlT9OrVC8nJybL3W1W0tLTw448/IjExEc2aNcOECRPwn//8p8qPu2DBAlhYWKBdu3bw9/eHr68vWrZsqdRnxowZuHbtGho2bCj9pezq6ooDBw7g6tWr6NChA9zd3TFt2rQy5yFoIl9fX1y8eLHM0YkXmTRpEmJiYrBs2TIkJydjwYIF2LJlCyZOnFjufZT3D5xDhw6hW7duFXpN1cnUqVPx6aefYtq0aXBxccH777+vNL8hIiICERERcHNzw+HDh/Hrr7++lsFKJeqeAUqkCfLy8oSZmZn473//q+5S6A3XunVrsXz5ciFE6btehBDi9OnTAoBIS0uT2spza+jWrVuV2szMzER0dLS0fPXqVdGvXz9hbm4uDAwMhLOzsxg/frwoLi4WQgjx+PFjYWZmprHPwKhKz9+NRKUphBBCvXGG6NU7ffo0rly5gtatWyM3NxczZszA/v37kZKSwr80SK127tyJSZMm4cKFCy8dqXzVli1bhq1bt+L3339Xdymv3LVr11C/fn2cPn36tf+sHVVxAia9sebNm4ekpCTo6urCw8MDhw4dYpAgtfPz80NycjJu3LghTf7VBDo6Oho9v4fUiyMTREREJIvmjKERERFRtcQwQURERLIwTBAREZEsDBNEREQkC8MEERERycIwQUSSR48eISAgAKamplAoFMjJySmzzdHREYsWLVJ3uS81ffp0pWcCBAcHo2/fvmqrh+h1xjBBVA0pFIqXfk2fPl2l/a5ZswaHDh3C0aNHcevWLZiZmZXZlpCQUOqTKivC0dERCoUCP/74Y6l1TZs2hUKhQExMjMr7L8vixYsrfZ9E9BQfWkVUDd26dUv6/qeffsK0adOQlJQktT37UdJCCBQVFZXrE2pTU1Ph4uKCZs2avbStMj41sl69eoiOjsbAgQOltvj4eGRkZFT4I+PLw8zMrNL3SURPcWSCqBqytbWVvszMzKBQKKTlK1euwMTEBLt27YKHhwf09PRw+PBhpKamok+fPrCxsYGxsTFatWqF2NhYaZ+dOnXC/PnzcfDgQSgUCnTq1KnMNgClLnPk5ORg1KhRsLGxgb6+Ppo1a4YdO3a89DUMHjwYBw4cwF9//SW1rV69GoMHDy4VfHJycjB8+HBYWVnB1NQUXbp0wdmzZ5X6REREwMbGBiYmJggJCUF+fr7S+ucvc5R1qaZFixZKozoKhQLfffcdevXqBUNDQ7i4uODYsWNISUlBp06dYGRkhHbt2iE1NfWlr5XodccwQfSa+vzzzxEREYHLly/D1dUVeXl56NmzJ/bt24fTp0+je/fu8Pf3R3p6OgBgy5YtGDFiBLy8vHDr1i1s2bKlzLbnFRcXo0ePHjhy5Ai+//57XLp0CREREdDW1n5pfTY2NvD19cWaNWsAPJ2v8dNPP5X5kc7vvfcesrKysGvXLiQmJqJly5bo2rUr7t27BwD4+eefMX36dMyePRsnT55E7dq1ERUVJfcUAnj6ab0ffvghzpw5A2dnZwwaNAijRo3ClClTcPLkSQghqs1HnBNVFV7mIHpNzZgxA++88460XLNmTbi5uUnLX3/9NbZu3Ypff/0VY8aMQc2aNWFoaAhdXV3Y2tpK/cpqe1ZsbCxOnDiBy5cv46233gIANGjQoFw1Dhs2DJ9++im++OILbNq0CQ0bNiz1QUqHDx/GiRMnkJWVBT09PQBPP1dl27Zt2LRpE0aOHIlFixYhJCQEISEhAICZM2ciNja21OiEKoYOHYoBAwYAAD777DN4eXlh6tSp8PX1BQB88sknGDp0qOzjEFVnHJkgek15enoqLefl5WHixIlwcXGBubk5jI2NcfnyZWlkQlVnzpxB3bp1pSBREX5+fsjLy8PBgwexevXqMkclzp49i7y8PFhaWsLY2Fj6SktLky4vXL58GW3atFHazsvLS7UX9BxXV1fpexsbGwBA8+bNldry8/Nx//79SjkeUXXEkQmi19TzkxgnTpyIvXv3Yt68eXBycoKBgQH69++PgoICWccxMDBQedsaNWpgyJAhCA8Px/Hjx7F169ZSffLy8lC7dm3s37+/1Dpzc3OVj62lpYXnP+ewsLCwVD8dHR3pe4VC8cK24uJilWshqu44MkH0hjhy5AiCg4PRr18/NG/eHLa2trh27Zrs/bq6uuLvv//G1atXVdp+2LBhOHDgAPr06QMLC4tS61u2bImMjAzUqFEDTk5OSl8lHxnv4uKC48ePK20XHx//0uNaWVkp3RVz//59pKWlqfQaiN50HJkgekM0atQIW7Zsgb+/PxQKBaZOnVopf017e3ujY8eOCAgIwIIFC+Dk5IQrV65AoVCge/fu/7q9i4sL7ty5A0NDwzLX+/j4wMvLC3379sXcuXPx1ltv4ebNm9i5cyf69esHT09PfPLJJwgODoanpyfat2+P9evX4+LFiy+du9GlSxfExMTA398f5ubmmDZt2r9OGiWisnFkgugNsWDBAlhYWKBdu3bw9/eHr68vWrZsWSn73rx5M1q1aoXAwEA0adIEkydPRlFRUbm3t7S0fOHlEoVCgd9++w0dO3bE0KFD8dZbb2HgwIG4fv26NIfh/fffx9SpUzF58mR4eHjg+vXrGD169EuPOWXKFHh7e6NXr17w8/ND37590bBhw/K/aCKSKMTzFw2JiIiIKoAjE0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsjBMEBERkSwME0RERCQLwwQRERHJwjBBREREsvw/XBxScvND+yQAAAAASUVORK5CYII=
" alt="Output" />
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">These results show that:<br>- Referral traffic has the highest bounce rate (67.4%). These are users that find the site organically, such as links from other websites, mentions on social media etc. A possible cause might be that the landing page of the fictional e-commerce store does not meet user expectations.<br>- Organic traffic bounce rate is also quite high (60%). This refers to all traffic that comes from a search engine and which was not sponsored (not an ad). The underlying cause might be bad SEO targeting or (amilar to before) poor first page experience.<br>- Affiliate traffic is bouncing a lot too (57.7%). This traffic is generated by affiliates (i.e. other websites), which receive a commission for each visit or conversion (e.g. signup or sale) they generate for the target website.<br>- The fact that direct traffic ("none") is also higher than expected (45.7%) makes it even more likely that the landing page needs improvement.<br>So let's investigate the landing pages further:<br><br><h3>Landing Page Bounce Analysis</h3><br><br>It would be useful to investigate which of the pages that users land on the website have high bounce rates, so that web design and UX improvements can be targeted to them:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

WITH bounce_stats AS(
SELECT
  h.page.pagePath AS landing_page,
  COUNT(DISTINCT visitId) AS total_sessions,
  SUM(CASE WHEN totals.pageViews = 1 THEN 1 ELSE 0 END) AS total_bounces
FROM
  `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
CROSS JOIN
  UNNEST(hits) AS h
WHERE
  h.hitNumber = 1
GROUP BY
  landing_page
)

SELECT
  *,
  ROUND(SAFE_DIVIDE(total_bounces, total_sessions) * 100,1)  AS bounce_rate
FROM
  bounce_stats
WHERE
  total_sessions &gt;= 10
ORDER BY
  bounce_rate DESC
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-8d910a0c-d8b6-4811-b88e-a48e6288c7dd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>landing_page</th>
      <th>total_sessions</th>
      <th>total_bounces</th>
      <th>bounce_rate</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>/google+redesign/electronics</td>
      <td>20</td>
      <td>14</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>1</th>
      <td>/asearch.html</td>
      <td>10</td>
      <td>7</td>
      <td>70.0</td>
    </tr>
    <tr>
      <th>2</th>
      <td>/google+redesign/drinkware</td>
      <td>23</td>
      <td>15</td>
      <td>65.2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>/google+redesign/shop+by+brand/youtube</td>
      <td>588</td>
      <td>363</td>
      <td>61.7</td>
    </tr>
    <tr>
      <th>4</th>
      <td>/store.html</td>
      <td>23</td>
      <td>14</td>
      <td>60.9</td>
    </tr>
    <tr>
      <th>5</th>
      <td>/google+redesign/lifestyle/fun/malibu+sunglass...</td>
      <td>10</td>
      <td>6</td>
      <td>60.0</td>
    </tr>
    <tr>
      <th>6</th>
      <td>/google+redesign/bags/backpacks/home</td>
      <td>14</td>
      <td>8</td>
      <td>57.1</td>
    </tr>
    <tr>
      <th>7</th>
      <td>/google+redesign/apparel/mens</td>
      <td>11</td>
      <td>6</td>
      <td>54.5</td>
    </tr>
    <tr>
      <th>8</th>
      <td>/google+redesign/electronics/audio/google+g+no...</td>
      <td>13</td>
      <td>7</td>
      <td>53.8</td>
    </tr>
    <tr>
      <th>9</th>
      <td>/google+redesign/accessories/stickers/home</td>
      <td>23</td>
      <td>12</td>
      <td>52.2</td>
    </tr>
    <tr>
      <th>10</th>
      <td>/google+redesign/apparel/mens/mens+t+shirts</td>
      <td>117</td>
      <td>61</td>
      <td>52.1</td>
    </tr>
    <tr>
      <th>11</th>
      <td>/google redesign/apparel/mens/mens t shirts</td>
      <td>14</td>
      <td>7</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>12</th>
      <td>/google+redesign/apparel</td>
      <td>27</td>
      <td>13</td>
      <td>48.1</td>
    </tr>
    <tr>
      <th>13</th>
      <td>/google+redesign/apparel/headgear</td>
      <td>11</td>
      <td>5</td>
      <td>45.5</td>
    </tr>
    <tr>
      <th>14</th>
      <td>/home</td>
      <td>1241</td>
      <td>554</td>
      <td>44.6</td>
    </tr>
    <tr>
      <th>15</th>
      <td>/google+redesign/bags</td>
      <td>25</td>
      <td>11</td>
      <td>44.0</td>
    </tr>
    <tr>
      <th>16</th>
      <td>/google+redesign/apparel/mens/mens+outerwear</td>
      <td>14</td>
      <td>6</td>
      <td>42.9</td>
    </tr>
    <tr>
      <th>17</th>
      <td>/google+redesign/apparel/womens/womens+t+shirts</td>
      <td>13</td>
      <td>5</td>
      <td>38.5</td>
    </tr>
    <tr>
      <th>18</th>
      <td>/basket.html</td>
      <td>35</td>
      <td>10</td>
      <td>28.6</td>
    </tr>
    <tr>
      <th>19</th>
      <td>/signin.html</td>
      <td>78</td>
      <td>18</td>
      <td>23.1</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-8d910a0c-d8b6-4811-b88e-a48e6288c7dd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-8d910a0c-d8b6-4811-b88e-a48e6288c7dd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-8d910a0c-d8b6-4811-b88e-a48e6288c7dd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-6da573b9-efe5-4e5b-aa6d-b73ec8fcd6e7">
      <button class="colab-df-quickchart" onclick="quickchart('df-6da573b9-efe5-4e5b-aa6d-b73ec8fcd6e7')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-6da573b9-efe5-4e5b-aa6d-b73ec8fcd6e7 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">- Page <code>/google+redesign/shop+by+brand/youtube</code> needs to be investigated as it has both high traffic and bounce rates.<br>- Pages like <code>/google+redesign/electronics</code>, <code>/asearch.html</code>, and <code>/google+redesign/drinkware</code> all have bounce rates above 65%. This may indicate that a)they offer a poor landing page experience (irrelevant content, slow loading) or b) their content is not consistent with what the user expects being directed to them.<br>- Pages such as <code>/basket.html</code> (28.6%) and <code>/signin.html</code> (23.1%) have very low bounce rates, which makes sense because they are not part of the general user navigation but rather part of a specific goal of the user.<br><br><h3>Session Duration / Time on Site</h3><br><br>It's interesting to investigate which pages engage the users most with:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery
WITH session_time AS(
SELECT
  visitId,
  MIN(h.time) / 1000 AS session_start_time_seconds,
  MAX(h.time) / 1000 AS session_end_time_seconds,
  CASE
    WHEN COUNT(h.time) = 1 THEN 0
    ELSE (MAX(h.time) - MIN(h.time)) / 1000
  END AS session_duration_seconds,
FROM
  `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
CROSS JOIN
  UNNEST(hits) AS h
WHERE
  -- Only real interactions
  h.isInteraction IS TRUE
GROUP BY
  visitId
ORDER BY
  session_duration_seconds DESC
)

SELECT
  AVG(session_duration_seconds) AS average_session_duration
FROM
  session_time
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-c2f32f87-0d4a-4a6d-991e-43a2187092bb" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>average_session_duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>169.279599</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-c2f32f87-0d4a-4a6d-991e-43a2187092bb')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-c2f32f87-0d4a-4a6d-991e-43a2187092bb button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-c2f32f87-0d4a-4a6d-991e-43a2187092bb');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>Session Duration by Channel/Device/Page</h3><br><br>How is the time a user spends on the site affected by the traffic channel, their device or page they come from? Let's find out below:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

WITH session_time AS(
SELECT
  visitId,
  MIN(h.time) / 1000 AS session_start_time_seconds,
  MAX(h.time) / 1000 AS session_end_time_seconds,
  CASE
    WHEN COUNT(h.time) = 1 THEN 0
    ELSE (MAX(h.time) - MIN(h.time)) / 1000
  END AS session_duration_seconds,
FROM
  `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
  -- Use cross join to explode an array into rows
CROSS JOIN
  UNNEST(hits) AS h
WHERE
  -- Only real interactions
  h.isInteraction IS TRUE
GROUP BY
  visitId
ORDER BY
  session_duration_seconds DESC
)

SELECT
  trafficSource.source,
  AVG(session_duration_seconds) AS avg_session_duration
FROM
  session_time
JOIN
  `bigquery-public-data.google_analytics_sample.ga_sessions_20170801` AS t
ON
  session_time.visitId = t.visitId
GROUP BY
  trafficSource.source
ORDER BY
  avg_session_duration DESC
LIMIT 20;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-73990016-8a72-456e-82de-a30bcc32d506" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>source</th>
      <th>avg_session_duration</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>mail.google.com</td>
      <td>736.833500</td>
    </tr>
    <tr>
      <th>1</th>
      <td>dealspotr.com</td>
      <td>656.197000</td>
    </tr>
    <tr>
      <th>2</th>
      <td>groups.google.com</td>
      <td>306.040000</td>
    </tr>
    <tr>
      <th>3</th>
      <td>facebook.com</td>
      <td>300.494429</td>
    </tr>
    <tr>
      <th>4</th>
      <td>m.facebook.com</td>
      <td>282.543600</td>
    </tr>
    <tr>
      <th>5</th>
      <td>away.vk.com</td>
      <td>223.079000</td>
    </tr>
    <tr>
      <th>6</th>
      <td>qiita.com</td>
      <td>207.634000</td>
    </tr>
    <tr>
      <th>7</th>
      <td>bing</td>
      <td>205.120000</td>
    </tr>
    <tr>
      <th>8</th>
      <td>(direct)</td>
      <td>188.420978</td>
    </tr>
    <tr>
      <th>9</th>
      <td>dfa</td>
      <td>157.198733</td>
    </tr>
    <tr>
      <th>10</th>
      <td>blog.golang.org</td>
      <td>122.895667</td>
    </tr>
    <tr>
      <th>11</th>
      <td>google.com.tw</td>
      <td>89.563000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Partners</td>
      <td>83.586654</td>
    </tr>
    <tr>
      <th>13</th>
      <td>google.com</td>
      <td>76.541250</td>
    </tr>
    <tr>
      <th>14</th>
      <td>analytics.google.com</td>
      <td>70.378561</td>
    </tr>
    <tr>
      <th>15</th>
      <td>sites.google.com</td>
      <td>59.438000</td>
    </tr>
    <tr>
      <th>16</th>
      <td>pinterest.com</td>
      <td>52.603000</td>
    </tr>
    <tr>
      <th>17</th>
      <td>adwords.google.com</td>
      <td>51.957500</td>
    </tr>
    <tr>
      <th>18</th>
      <td>yahoo</td>
      <td>47.798000</td>
    </tr>
    <tr>
      <th>19</th>
      <td>docs.google.com</td>
      <td>46.792000</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-73990016-8a72-456e-82de-a30bcc32d506')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-73990016-8a72-456e-82de-a30bcc32d506 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-73990016-8a72-456e-82de-a30bcc32d506');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-cf966bcc-4b42-46f1-a79a-75408a97c08d">
      <button class="colab-df-quickchart" onclick="quickchart('df-cf966bcc-4b42-46f1-a79a-75408a97c08d')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-cf966bcc-4b42-46f1-a79a-75408a97c08d button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">These results show that:<br><br>- <code>mail.google.com</code> (736 seconds) and <code>dealspotr.com</code> (656 seconds) stand out with high average session durations - over 10 minutes and almost 11 minutes, respectively. This suggests either very high user intent or that users likely clicked through targeted or interesting content.<br>- <code>m.facebook.com</code> (mobile Facebook) shows slightly lower session duration (282s) compared to desktop Facebook (300s). This is to be expected, as mobile users generally have shorter sessions due to different browsing habits.<br>- <code>bing</code> (205s) and <code>google.com</code> (76s) show lower average session times compared to direct referral links. Organic searchers may be looking for quick answers rather than deep engagement.<br><br><h3>Hits</h3><br><br>As explained earlier, a hit in Google Analytics refers to <em>any user interaction with the website that results in data being sent to the Analytics server</em>, such as viewing a page or clicking a button. Below we'll calculate average page and event (e.g. clicks, video plays, downloads, etc.) hits per session (visit).</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery
-- Let's calculate average page and event hits per session

WITH hit_table AS(
    SELECT
        visitId,
        SUM(CASE WHEN h.type = 'PAGE' THEN 1 ELSE 0 END) AS page_hits,
        SUM(CASE WHEN h.type = 'EVENT' THEN 1 ELSE 0 END) AS event_hits,
    FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`,
    UNNEST(hits) AS h
    GROUP BY visitId
)

SELECT
    ROUND(AVG(page_hits), 2) AS avg_page_hits_per_session,
    ROUND(AVG(event_hits), 2) AS avg_event_hits_per_session,
    COUNT(*) AS total_sessions
FROM
    hit_table;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-af50228b-0840-47b6-b6e7-e8920bdc14f2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_page_hits_per_session</th>
      <th>avg_event_hits_per_session</th>
      <th>total_sessions</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>4.36</td>
      <td>0.91</td>
      <td>2509</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-af50228b-0840-47b6-b6e7-e8920bdc14f2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-af50228b-0840-47b6-b6e7-e8920bdc14f2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-af50228b-0840-47b6-b6e7-e8920bdc14f2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">From these results we conclude that we have 4.36 pageviews per session, which is considered normal to good in web analytics. A good score is often between 3-5 pages per session, but that depends on the nature of the website of course. We can also see that there is user interaction, as 0.91 events per session means almost every session triggers an event (clicks, video plays, etc.). Therefore visitors are not being passive.</div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h3>How are hit events related to transactions and revenue?</h3><br><br>I'll start by examining whether clicking events are related to conversion, by calculating the following metrics:<br>- Overall average events per session<br>- Average events per session where conversion took place<br>- Total conversion rate<br>- Average revenue per session</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

WITH session_summary AS (
    SELECT
        fullVisitorId,
        visitId,
        SUM(CASE WHEN h.type = 'EVENT' THEN 1 ELSE 0 END) AS event_count,
        IFNULL(totals.transactions, 0) AS transactions,
        IFNULL(totals.transactionRevenue, 0) / 1e6 AS transaction_revenue -- GA stores revenue in micros (divide by 1M)
    FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`,
    UNNEST(hits) AS h
    GROUP BY fullVisitorId, visitId, totals.transactions, totals.transactionRevenue
)

SELECT
    ROUND(AVG(event_count), 2) AS avg_events_per_session,
    ROUND(AVG(CASE WHEN transactions &gt; 0 THEN event_count ELSE NULL END), 2) AS avg_events_in_converting_sessions,
    ROUND(SUM(transactions) / COUNT(*), 4) AS conversion_rate,
    ROUND(SUM(transaction_revenue) / COUNT(*), 2) AS avg_revenue_per_session
FROM
    session_summary;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-bf39d632-9492-4640-b90c-e68ac5598dd6" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>avg_events_per_session</th>
      <th>avg_events_in_converting_sessions</th>
      <th>conversion_rate</th>
      <th>avg_revenue_per_session</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.9</td>
      <td>10.37</td>
      <td>0.0176</td>
      <td>3.25</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-bf39d632-9492-4640-b90c-e68ac5598dd6')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-bf39d632-9492-4640-b90c-e68ac5598dd6 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-bf39d632-9492-4640-b90c-e68ac5598dd6');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">These results show that there is a big difference in engagement: The typical session has about 1 event, but events with a transaction (converting sessions) have over 10 events on average! In other words, more engaged sessions (users who trigger many events) are far more likely to convert. Conversion rate is approximately 1.76%, which is [generally considered](https://business.adobe.com/blog/basics/ecommerce-conversion-rate-benchmarks) acceptable for ecommerce or lead generation websites, as industry benchmarks often range 1%–3%. Finally, the average revenue per session (\$3.25) should be evaluated based on the products sold. As this ecommerce site sells hoodies etc. (priced around \$30-40 USD), we could consider this average as acceptable.<br><br><h3>Event breakdown</h3><br><br>In Google Analytics data (in this case GA3, which the sample dataset is from), event data is hierarchically organized as follows:<br>- Event Category (broad category)<br>- Event Action (what the user did inside the category)<br>- Event Label (additional description detail)<br><br>So I'll start by exploring the hit types, grouping them in that order, counting the number of times they occured and displaying the conversion event ratios:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

WITH event_data AS (
    SELECT
        h.eventInfo.eventCategory AS event_category,
        h.eventInfo.eventAction AS event_action,
        h.eventInfo.eventLabel AS event_label,
        IFNULL(totals.transactions, 0) AS transactions
    FROM
        `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`,
        UNNEST(hits) AS h
    WHERE
        h.type = 'EVENT'
)

SELECT
    event_category,
    event_action,
    event_label,
    COUNT(*) AS total_event_occurrences,
    -- Mark the sessions that had transactions
    SUM(CASE WHEN transactions &gt; 0 THEN 1 ELSE 0 END) AS event_in_converting_sessions,
    -- Give the ratio of the events that had transactions to the total event occurences
    ROUND(SAFE_DIVIDE(SUM(CASE WHEN transactions &gt; 0 THEN 1 ELSE 0 END), COUNT(*)) * 100, 1) AS conversion_event_ratio
FROM
    event_data
GROUP BY
    event_category, event_action, event_label
ORDER BY
    event_in_converting_sessions DESC
LIMIT 10;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-e2196a9d-ac50-4af5-a067-29629cf38fb2" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>event_category</th>
      <th>event_action</th>
      <th>event_label</th>
      <th>total_event_occurrences</th>
      <th>event_in_converting_sessions</th>
      <th>conversion_event_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Enhanced Ecommerce</td>
      <td>Add to Cart</td>
      <td>None</td>
      <td>494</td>
      <td>175</td>
      <td>35.4</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Enhanced Ecommerce</td>
      <td>Product Click</td>
      <td>None</td>
      <td>411</td>
      <td>64</td>
      <td>15.6</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Enhanced Ecommerce</td>
      <td>Remove from Cart</td>
      <td>None</td>
      <td>75</td>
      <td>22</td>
      <td>29.3</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Infant Short Sleeve Tee Green</td>
      <td>10</td>
      <td>10</td>
      <td>100.0</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Men's Zip Hoodie</td>
      <td>18</td>
      <td>9</td>
      <td>50.0</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Men's 100% Cotton Short Sleeve Hero Tee...</td>
      <td>38</td>
      <td>7</td>
      <td>18.4</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Canvas Tote Natural/Navy</td>
      <td>17</td>
      <td>7</td>
      <td>41.2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Women's Performance Full Zip Jacket Black</td>
      <td>13</td>
      <td>6</td>
      <td>46.2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Youth Baseball Raglan Heather/Black</td>
      <td>7</td>
      <td>5</td>
      <td>71.4</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Enhanced Ecommerce</td>
      <td>Quickview Click</td>
      <td>Google Tote Bag</td>
      <td>9</td>
      <td>5</td>
      <td>55.6</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-e2196a9d-ac50-4af5-a067-29629cf38fb2')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-e2196a9d-ac50-4af5-a067-29629cf38fb2 button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-e2196a9d-ac50-4af5-a067-29629cf38fb2');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-7f3f1b7c-3941-4b62-a21e-5e15027e0c47">
      <button class="colab-df-quickchart" onclick="quickchart('df-7f3f1b7c-3941-4b62-a21e-5e15027e0c47')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-7f3f1b7c-3941-4b62-a21e-5e15027e0c47 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">From the above table we can draw that users who added to cart were much more likely to convert (which makes sense), as they have a 35.4% conversion ratio. "Quickview Click" events in particular (i.e. on individual products) have high conversion ratios (some range between 50–100%).<br><br><h3>Funnel exploration</h3><br><br>Funnel exploration lets us understand the steps users of a website take to complete a task, in this case conversion (a transaction) and evaluate how many users drop off between each step. For this purpose, I'll examine the chained sequence of the following:<br><br>1. Product click or Quickview click (note: there is no guaranteed sequence between Product click and Quickview click, so in reality this would depend on the functionality of the website)<br>2. Add to Cart<br>3. Transaction</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

WITH funnel_data AS (
    SELECT
        visitId,
        -- If at least 1 of the following events has taken place, assign the value 1
        MAX(CASE WHEN h.eventInfo.eventAction = 'Product Click' THEN 1 ELSE 0 END) AS product_click_count,
        MAX(CASE WHEN h.eventInfo.eventAction = 'Quickview Click' THEN 1 ELSE 0 END) AS quickview_click_count,
        MAX(CASE WHEN h.eventInfo.eventAction = 'Add to Cart' THEN 1 ELSE 0 END) AS add_to_cart_count,
        IFNULL(MAX(totals.transactions), 0) AS transaction_total
    FROM
        `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`,
        UNNEST(hits) AS h
    WHERE
        h.type = 'EVENT'
    GROUP BY
        visitId
)

SELECT
    COUNT(DISTINCT visitId) AS total_visits,
    SUM(CASE WHEN product_click_count=1 OR quickview_click_count=1 THEN 1 ELSE 0 END) AS product_or_quickview_session,
    SUM(CASE WHEN (product_click_count=1 OR quickview_click_count=1) AND add_to_cart_count=1 THEN 1 ELSE 0 END) AS product_or_quickview_and_cart_session,
    SUM(CASE WHEN (product_click_count=1 OR quickview_click_count=1) AND add_to_cart_count=1 AND transaction_total&gt;0 THEN 1 ELSE 0 END) AS product_or_quickview_cart_transaction_session
FROM
    funnel_data;
</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-1dbac701-a8a9-4618-a374-9aff42dbaadd" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_visits</th>
      <th>product_or_quickview_session</th>
      <th>product_or_quickview_and_cart_session</th>
      <th>product_or_quickview_cart_transaction_session</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>480</td>
      <td>430</td>
      <td>152</td>
      <td>30</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-1dbac701-a8a9-4618-a374-9aff42dbaadd')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-1dbac701-a8a9-4618-a374-9aff42dbaadd button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-1dbac701-a8a9-4618-a374-9aff42dbaadd');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell">The results show that one out of three users (152/430 = 35.3%) who interacted went on to add a product to cart; in addition, approximately only one out of five users (30/152 = 19.7%) who added a product in the cart went on to complete the transaction.<br><br>Let's further explore the sessions that were the most engaging in terms of pageviews, and led to a transaction:</div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>%%bigquery

WITH average_pageviews AS (
  SELECT AVG(totals.pageviews) AS avg_pageviews
    FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
    WHERE totals.pageviews IS NOT NULL
)

SELECT
  fullVisitorId,
  visitId,
  totals.pageviews,
  avg_pageviews,
  totals.transactions,
  totals.transactionRevenue / 1e6 AS revenue
FROM
  `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
CROSS JOIN
  average_pageviews
WHERE
  totals.transactions IS NOT NULL
  AND totals.pageviews &gt; (
    SELECT AVG(totals.pageviews) AS avg_pageviews
    FROM `bigquery-public-data.google_analytics_sample.ga_sessions_20170801`
    WHERE totals.pageviews IS NOT NULL
  )
ORDER BY
  revenue DESC
LIMIT 10;

</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Query is running:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-result"><pre>Downloading:   0%|          |</pre></div>
                        </div>
                    </div>
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html">
  <div id="df-5c132c9f-f99e-4d76-ae5f-5908a99ab00c" class="colab-df-container">
    <div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fullVisitorId</th>
      <th>visitId</th>
      <th>pageviews</th>
      <th>avg_pageviews</th>
      <th>transactions</th>
      <th>revenue</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>9308310352918219134</td>
      <td>1501608078</td>
      <td>55</td>
      <td>4.279734</td>
      <td>1</td>
      <td>2933.61</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0126612099954375841</td>
      <td>1501606687</td>
      <td>32</td>
      <td>4.279734</td>
      <td>1</td>
      <td>1000.78</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7311242886083854158</td>
      <td>1501623886</td>
      <td>17</td>
      <td>4.279734</td>
      <td>1</td>
      <td>982.73</td>
    </tr>
    <tr>
      <th>3</th>
      <td>7420300501523012460</td>
      <td>1501627131</td>
      <td>112</td>
      <td>4.279734</td>
      <td>1</td>
      <td>400.21</td>
    </tr>
    <tr>
      <th>4</th>
      <td>4871061239735971842</td>
      <td>1501604340</td>
      <td>18</td>
      <td>4.279734</td>
      <td>1</td>
      <td>347.14</td>
    </tr>
    <tr>
      <th>5</th>
      <td>8719058463049309640</td>
      <td>1501602101</td>
      <td>27</td>
      <td>4.279734</td>
      <td>1</td>
      <td>313.38</td>
    </tr>
    <tr>
      <th>6</th>
      <td>5371617068925994598</td>
      <td>1501631449</td>
      <td>23</td>
      <td>4.279734</td>
      <td>1</td>
      <td>234.53</td>
    </tr>
    <tr>
      <th>7</th>
      <td>454845221896711463</td>
      <td>1501608216</td>
      <td>13</td>
      <td>4.279734</td>
      <td>1</td>
      <td>200.00</td>
    </tr>
    <tr>
      <th>8</th>
      <td>9008243837280281377</td>
      <td>1501624252</td>
      <td>34</td>
      <td>4.279734</td>
      <td>1</td>
      <td>170.39</td>
    </tr>
    <tr>
      <th>9</th>
      <td>7420300501523012460</td>
      <td>1501640730</td>
      <td>21</td>
      <td>4.279734</td>
      <td>1</td>
      <td>169.90</td>
    </tr>
  </tbody>
</table>
</div>
    <div class="colab-df-buttons">

  <div class="colab-df-container">
    <button class="colab-df-convert" onclick="convertToInteractive('df-5c132c9f-f99e-4d76-ae5f-5908a99ab00c')"
            title="Convert this dataframe to an interactive table."
            style="display:none;">

  <svg xmlns="http://www.w3.org/2000/svg" height="24px" viewBox="0 -960 960 960">
    <path d="M120-120v-720h720v720H120Zm60-500h600v-160H180v160Zm220 220h160v-160H400v160Zm0 220h160v-160H400v160ZM180-400h160v-160H180v160Zm440 0h160v-160H620v160ZM180-180h160v-160H180v160Zm440 0h160v-160H620v160Z"/>
  </svg>
    </button>

  <style>
    .colab-df-container {
      display:flex;
      gap: 12px;
    }

    .colab-df-convert {
      background-color: #E8F0FE;
      border: none;
      border-radius: 50%;
      cursor: pointer;
      display: none;
      fill: #1967D2;
      height: 32px;
      padding: 0 0 0 0;
      width: 32px;
    }

    .colab-df-convert:hover {
      background-color: #E2EBFA;
      box-shadow: 0px 1px 2px rgba(60, 64, 67, 0.3), 0px 1px 3px 1px rgba(60, 64, 67, 0.15);
      fill: #174EA6;
    }

    .colab-df-buttons div {
      margin-bottom: 4px;
    }

    [theme=dark] .colab-df-convert {
      background-color: #3B4455;
      fill: #D2E3FC;
    }

    [theme=dark] .colab-df-convert:hover {
      background-color: #434B5C;
      box-shadow: 0px 1px 3px 1px rgba(0, 0, 0, 0.15);
      filter: drop-shadow(0px 1px 2px rgba(0, 0, 0, 0.3));
      fill: #FFFFFF;
    }
  </style>

    <script>
      const buttonEl =
        document.querySelector('#df-5c132c9f-f99e-4d76-ae5f-5908a99ab00c button.colab-df-convert');
      buttonEl.style.display =
        google.colab.kernel.accessAllowed ? 'block' : 'none';

      async function convertToInteractive(key) {
        const element = document.querySelector('#df-5c132c9f-f99e-4d76-ae5f-5908a99ab00c');
        const dataTable =
          await google.colab.kernel.invokeFunction('convertToInteractive',
                                                    [key], {});
        if (!dataTable) return;

        const docLinkHtml = 'Like what you see? Visit the ' +
          '<a target="_blank" href=https://colab.research.google.com/notebooks/data_table.ipynb>data table notebook</a>'
          + ' to learn more about interactive tables.';
        element.innerHTML = '';
        dataTable['output_type'] = 'display_data';
        await google.colab.output.renderOutput(dataTable, element);
        const docLink = document.createElement('div');
        docLink.innerHTML = docLinkHtml;
        element.appendChild(docLink);
      }
    </script>
  </div>


    <div id="df-55bacfe4-8d97-4a67-b9b3-c8d66dd4f3e9">
      <button class="colab-df-quickchart" onclick="quickchart('df-55bacfe4-8d97-4a67-b9b3-c8d66dd4f3e9')"
                title="Suggest charts"
                style="display:none;">

<svg xmlns="http://www.w3.org/2000/svg" height="24px"viewBox="0 0 24 24"
     width="24px">
    <g>
        <path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zM9 17H7v-7h2v7zm4 0h-2V7h2v10zm4 0h-2v-4h2v4z"/>
    </g>
</svg>
      </button>

<style>
  .colab-df-quickchart {
      --bg-color: #E8F0FE;
      --fill-color: #1967D2;
      --hover-bg-color: #E2EBFA;
      --hover-fill-color: #174EA6;
      --disabled-fill-color: #AAA;
      --disabled-bg-color: #DDD;
  }

  [theme=dark] .colab-df-quickchart {
      --bg-color: #3B4455;
      --fill-color: #D2E3FC;
      --hover-bg-color: #434B5C;
      --hover-fill-color: #FFFFFF;
      --disabled-bg-color: #3B4455;
      --disabled-fill-color: #666;
  }

  .colab-df-quickchart {
    background-color: var(--bg-color);
    border: none;
    border-radius: 50%;
    cursor: pointer;
    display: none;
    fill: var(--fill-color);
    height: 32px;
    padding: 0;
    width: 32px;
  }

  .colab-df-quickchart:hover {
    background-color: var(--hover-bg-color);
    box-shadow: 0 1px 2px rgba(60, 64, 67, 0.3), 0 1px 3px 1px rgba(60, 64, 67, 0.15);
    fill: var(--button-hover-fill-color);
  }

  .colab-df-quickchart-complete:disabled,
  .colab-df-quickchart-complete:disabled:hover {
    background-color: var(--disabled-bg-color);
    fill: var(--disabled-fill-color);
    box-shadow: none;
  }

  .colab-df-spinner {
    border: 2px solid var(--fill-color);
    border-color: transparent;
    border-bottom-color: var(--fill-color);
    animation:
      spin 1s steps(1) infinite;
  }

  @keyframes spin {
    0% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
      border-left-color: var(--fill-color);
    }
    20% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    30% {
      border-color: transparent;
      border-left-color: var(--fill-color);
      border-top-color: var(--fill-color);
      border-right-color: var(--fill-color);
    }
    40% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-top-color: var(--fill-color);
    }
    60% {
      border-color: transparent;
      border-right-color: var(--fill-color);
    }
    80% {
      border-color: transparent;
      border-right-color: var(--fill-color);
      border-bottom-color: var(--fill-color);
    }
    90% {
      border-color: transparent;
      border-bottom-color: var(--fill-color);
    }
  }
</style>

      <script>
        async function quickchart(key) {
          const quickchartButtonEl =
            document.querySelector('#' + key + ' button');
          quickchartButtonEl.disabled = true;  // To prevent multiple clicks.
          quickchartButtonEl.classList.add('colab-df-spinner');
          try {
            const charts = await google.colab.kernel.invokeFunction(
                'suggestCharts', [key], {});
          } catch (error) {
            console.error('Error during call to suggestCharts:', error);
          }
          quickchartButtonEl.classList.remove('colab-df-spinner');
          quickchartButtonEl.classList.add('colab-df-quickchart-complete');
        }
        (() => {
          let quickchartButtonEl =
            document.querySelector('#df-55bacfe4-8d97-4a67-b9b3-c8d66dd4f3e9 button');
          quickchartButtonEl.style.display =
            google.colab.kernel.accessAllowed ? 'block' : 'none';
        })();
      </script>
    </div>

    </div>
  </div>
</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-code">
            <div class="cell-prompt input-prompt">In [ ]:</div>
            <div class="cell-content">
                <div class="input-area"><pre>labels = [
    "Total Visits",
    "Product or Quickview",
    "Added to Cart",
    "Transactions"
]

values = [480, 430, 152, 30]

fig = go.Figure(go.Funnel(
    y=labels,
    x=values,
    textinfo="value+percent initial",
    orientation="h",
    marker=dict(color=color_palette[1])
))

fig.update_layout(
    title="User Journey Funnel",
    width=900,
    height=500
)

fig.show()</pre></div>
                <div class="output-area">
                    <div class="output-wrapper">
                        <div class="cell-prompt output-prompt"></div>
                        <div class="output-content">
                            <div class="output-html"><html>
<head><meta charset="utf-8" /></head>
<body>
    <div>            <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_SVG"></script><script type="text/javascript">if (window.MathJax && window.MathJax.Hub && window.MathJax.Hub.Config) {window.MathJax.Hub.Config({SVG: {font: "STIX-Web"}});}</script>                <script type="text/javascript">window.PlotlyConfig = {MathJaxConfig: 'local'};</script>
        <script charset="utf-8" src="https://cdn.plot.ly/plotly-3.3.0.min.js" integrity="sha256-bO3dS6yCpk9aK4gUpNELtCiDeSYvGYnK7jFI58NQnHI=" crossorigin="anonymous"></script>                <div id="23f55d61-c73f-468f-aa18-9685f369ad35" class="plotly-graph-div" style="height:500px; width:900px;"></div>            <script type="text/javascript">                window.PLOTLYENV=window.PLOTLYENV || {};                                if (document.getElementById("23f55d61-c73f-468f-aa18-9685f369ad35")) {                    Plotly.newPlot(                        "23f55d61-c73f-468f-aa18-9685f369ad35",                        [{"marker":{"color":"#40798C"},"orientation":"h","textinfo":"value+percent initial","x":[480,430,152,30],"y":["Total Visits","Product or Quickview","Added to Cart","Transactions"],"type":"funnel"}],                        {"template":{"data":{"histogram2dcontour":[{"type":"histogram2dcontour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"choropleth":[{"type":"choropleth","colorbar":{"outlinewidth":0,"ticks":""}}],"histogram2d":[{"type":"histogram2d","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"heatmap":[{"type":"heatmap","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"contourcarpet":[{"type":"contourcarpet","colorbar":{"outlinewidth":0,"ticks":""}}],"contour":[{"type":"contour","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"surface":[{"type":"surface","colorbar":{"outlinewidth":0,"ticks":""},"colorscale":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]]}],"mesh3d":[{"type":"mesh3d","colorbar":{"outlinewidth":0,"ticks":""}}],"scatter":[{"fillpattern":{"fillmode":"overlay","size":10,"solidity":0.2},"type":"scatter"}],"parcoords":[{"type":"parcoords","line":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolargl":[{"type":"scatterpolargl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"bar":[{"error_x":{"color":"#2a3f5f"},"error_y":{"color":"#2a3f5f"},"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"bar"}],"scattergeo":[{"type":"scattergeo","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterpolar":[{"type":"scatterpolar","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"histogram":[{"marker":{"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"histogram"}],"scattergl":[{"type":"scattergl","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatter3d":[{"type":"scatter3d","line":{"colorbar":{"outlinewidth":0,"ticks":""}},"marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermap":[{"type":"scattermap","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattermapbox":[{"type":"scattermapbox","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scatterternary":[{"type":"scatterternary","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"scattercarpet":[{"type":"scattercarpet","marker":{"colorbar":{"outlinewidth":0,"ticks":""}}}],"carpet":[{"aaxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"baxis":{"endlinecolor":"#2a3f5f","gridcolor":"#C8D4E3","linecolor":"#C8D4E3","minorgridcolor":"#C8D4E3","startlinecolor":"#2a3f5f"},"type":"carpet"}],"table":[{"cells":{"fill":{"color":"#EBF0F8"},"line":{"color":"white"}},"header":{"fill":{"color":"#C8D4E3"},"line":{"color":"white"}},"type":"table"}],"barpolar":[{"marker":{"line":{"color":"white","width":0.5},"pattern":{"fillmode":"overlay","size":10,"solidity":0.2}},"type":"barpolar"}],"pie":[{"automargin":true,"type":"pie"}]},"layout":{"autotypenumbers":"strict","colorway":["#636efa","#EF553B","#00cc96","#ab63fa","#FFA15A","#19d3f3","#FF6692","#B6E880","#FF97FF","#FECB52"],"font":{"color":"#2a3f5f"},"hovermode":"closest","hoverlabel":{"align":"left"},"paper_bgcolor":"white","plot_bgcolor":"white","polar":{"bgcolor":"white","angularaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""},"radialaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":""}},"ternary":{"bgcolor":"white","aaxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"baxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""},"caxis":{"gridcolor":"#DFE8F3","linecolor":"#A2B1C6","ticks":""}},"coloraxis":{"colorbar":{"outlinewidth":0,"ticks":""}},"colorscale":{"sequential":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"sequentialminus":[[0.0,"#0d0887"],[0.1111111111111111,"#46039f"],[0.2222222222222222,"#7201a8"],[0.3333333333333333,"#9c179e"],[0.4444444444444444,"#bd3786"],[0.5555555555555556,"#d8576b"],[0.6666666666666666,"#ed7953"],[0.7777777777777778,"#fb9f3a"],[0.8888888888888888,"#fdca26"],[1.0,"#f0f921"]],"diverging":[[0,"#8e0152"],[0.1,"#c51b7d"],[0.2,"#de77ae"],[0.3,"#f1b6da"],[0.4,"#fde0ef"],[0.5,"#f7f7f7"],[0.6,"#e6f5d0"],[0.7,"#b8e186"],[0.8,"#7fbc41"],[0.9,"#4d9221"],[1,"#276419"]]},"xaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","automargin":true,"zerolinewidth":2},"yaxis":{"gridcolor":"#EBF0F8","linecolor":"#EBF0F8","ticks":"","title":{"standoff":15},"zerolinecolor":"#EBF0F8","automargin":true,"zerolinewidth":2},"scene":{"xaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8","gridwidth":2},"yaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8","gridwidth":2},"zaxis":{"backgroundcolor":"white","gridcolor":"#DFE8F3","linecolor":"#EBF0F8","showbackground":true,"ticks":"","zerolinecolor":"#EBF0F8","gridwidth":2}},"shapedefaults":{"line":{"color":"#2a3f5f"}},"annotationdefaults":{"arrowcolor":"#2a3f5f","arrowhead":0,"arrowwidth":1},"geo":{"bgcolor":"white","landcolor":"white","subunitcolor":"#C8D4E3","showland":true,"showlakes":true,"lakecolor":"white"},"title":{"x":0.05},"mapbox":{"style":"light"}}},"title":{"text":"User Journey Funnel"},"width":900,"height":500},                        {"responsive": true}                    ).then(function(){
                            
var gd = document.getElementById('23f55d61-c73f-468f-aa18-9685f369ad35');
var x = new MutationObserver(function (mutations, observer) {{
        var display = window.getComputedStyle(gd).display;
        if (!display || display === 'none') {{
            console.log([gd, 'removed!']);
            Plotly.purge(gd);
            observer.disconnect();
        }}
}});

// Listen for the removal of the full notebook cells
var notebookContainer = gd.closest('#notebook-container');
if (notebookContainer) {{
    x.observe(notebookContainer, {childList: true});
}}

// Listen for the clearing of the current output cell
var outputEl = gd.closest('.output');
if (outputEl) {{
    x.observe(outputEl, {childList: true});
}}

                        })                };            </script>        </div>
</body>
</html></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="cell cell-markdown">
            <div class="cell-prompt prompt-empty">&nbsp;</div>
            <div class="cell-content">
                <div class="markdown-cell"><h2>Conclusions</h2><br><br>In this project, we performed an in-depth analysis of a Google Analytics sample dataset using BigQuery and SQL. The goal was to understand user behavior, traffic sources, engagement patterns, and factors leading to revenue generation. The main conclusions are summarized below:<br><br><h3>Traffic Sources</h3><br>Direct traffic was the dominant source, contributing the highest number of sessions and the majority of revenue (\$8,292.98). <code>mail.google.com</code> also generated some revenue, though much smaller in scale. Most other sources, including <code>analytics.google.com</code> and <code>adwords.google.com</code>, contributed little or no revenue during the observed period.<br><br><h3>Devices Used</h3><br>Desktop devices accounted for approximately two-thirds of sessions, while mobile and tablet users made up the remaining third. Despite lower session counts, mobile users demonstrated considerable engagement, indicating the importance of maintaining a strong mobile user experience.<br><br><h3>User Types</h3><br>Returning visitors proved to be significantly more valuable than new visitors, as their conversion rates were approximately 8.5 times higher than for new users. Returning visitors also generated substantially higher revenue per session (\$11.16 versus \$0.36).<br><br>This suggests that retention efforts (e.g., loyalty programs, targeted campaigns) could have a major impact on overall business performance.<br><br><h3>Geographic Insights</h3><br><br>United States was by far the leading market, accounting for both the highest number of sessions and the largest amount of revenue Finland had an unusually high conversion rate relative to its small number of sessions, suggesting potential for targeted marketing in niche markets.<br><br><h3>Bounce Rates and Landing Pages</h3><br><br>Referral and organic traffic had the highest bounce rates, suggesting possible mismatches between user expectations and landing page content. Specific landing pages, such as <code>/google+redesign/electronics</code> and <code>/asearch.html</code>, exhibited high bounce rates (above 65%), making them candidates for UX review and improvement.<br><br><h3>Session Duration and Engagement</h3><br>Sessions referred by <code>mail.google.com</code> and <code>dealspotr.com</code> had the highest average session durations, suggesting strong engagement when users arrived from these sources. Direct traffic showed moderate engagement compared to organic and paid channels. It's important to note that high session durations correlated with higher conversion likelihood, so user engagement should be encouraged!<br><br>In addition, events like "Add to Cart" and "Product Click" were strongly associated with conversions. Sessions where users triggered multiple events (especially more than 10) had significantly higher conversion rates compared to sessions with minimal interaction.<br><br><h3>Funnel Analysis</h3><br><br>Finally, with regards to the funnel analysis, we can draw that:<br>- Only about 35% of users who interacted with a product (via click or quickview) proceeded to add it to the cart.<br>- Of those who added a product to the cart, only 20% completed a transaction.<br><br>This points to potential drop-off points in the purchase funnel where targeted interventions (e.g., retargeting, promotions, cart abandonment emails) could improve conversion rates.<br><br></div>
            </div>
        </div>
    </div>
    <footer class="export-footer">
        Exported with <a href="https://www.runcell.dev/tool/ipynb-to-html">runcell</a> — convert notebooks to HTML or PDF anytime at runcell.dev.
    </footer>
</body>
</html>